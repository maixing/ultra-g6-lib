!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@antv/g6"),require("react"),require("lodash")):"function"==typeof define&&define.amd?define(["@antv/g6","react","lodash"],t):"object"==typeof exports?exports["g6lib.min.js"]=t(require("@antv/g6"),require("react"),require("lodash")):e["g6lib.min.js"]=t(e["@antv/g6"],e.React,e.lodash)}(window,(function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){e.exports=r(6)()},function(e,t){e.exports=r},function(e,t,r){},function(e,t,r){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=42)}({12:function(e,t){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){var t=void 0===e?"undefined":r(e);return null!==e&&"object"===t||"function"===t}},14:function(e,t){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":r(e))&&null!==e}},15:function(e,t,r){var n=r(14),o=r(4);e.exports=function(e){if(!n(e)||!o(e,"Object"))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},17:function(e,t){e.exports=function(e,t){if(e["_wrap_"+t])return e["_wrap_"+t];var r=function(r){e[t](r)};return e["_wrap_"+t]=r,r}},2:function(e,t,r){var n=r(15),o=r(3),i=5;function a(e,t,r,c){for(var s in r=r||0,c=c||i,t)if(t.hasOwnProperty(s)){var u=t[s];null!==u&&n(u)?(n(e[s])||(e[s]={}),r<c?a(e[s],u,r+1,c):e[s]=t[s]):o(u)?(e[s]=[],e[s]=e[s].concat(u)):void 0!==u&&(e[s]=u)}}e.exports=function(){for(var e=new Array(arguments.length),t=e.length,r=0;r<t;r++)e[r]=arguments[r];for(var n=e[0],o=1;o<t;o++)a(n,e[o]);return n}},21:function(e,t){var r=document.createElement("table"),n=document.createElement("tr"),o=/^\s*<(\w+|!)[^>]*>/,i={tr:document.createElement("tbody"),tbody:r,thead:r,tfoot:r,td:n,th:n,"*":document.createElement("div")};e.exports=function(e){var t=o.test(e)&&RegExp.$1;t in i||(t="*");var r=i[t];e=e.replace(/(^\s*)|(\s*$)/g,""),r.innerHTML=""+e;var n=r.childNodes[0];return r.removeChild(n),n}},3:function(e,t,r){var n=r(4),o=Array.isArray?Array.isArray:function(e){return n(e,"Array")};e.exports=o},4:function(e,t){var r={}.toString;e.exports=function(e,t){return r.call(e)==="[object "+t+"]"}},42:function(e,t,r){var n=r(8),o=r(21),i=r(9),a=function(e){function t(){return e.apply(this,arguments)||this}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var r=t.prototype;return r.init=function(){var e=this.get("graph"),t=e.get("minZoom"),r=e.get("container"),n=e.get("canvas").get("el"),a=e.get("width"),c=e.get("height"),s=o('<div style="position: absolute; left:0;top:0;right:0;bottom:0;overflow: hidden;z-index: -1;"></div>'),u=o('<div class="g6-grid" style="position:absolute;transform-origin: 0% 0% 0px; background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)"></div>');s.appendChild(u),i(u,{width:a/t+"px",height:c/t+"px",left:0,top:0}),r.insertBefore(s,n),this.set("container",s),this.set("gridContainer",u)},r.getEvents=function(){return{viewportchange:"updateGrid"}},r.updateGrid=function(e){var t=this.get("gridContainer"),r=e.matrix,n="matrix("+r[0]+","+r[1]+","+r[3]+","+r[4]+",0,0)";i(t,{transform:n})},r.getContainer=function(){return this.get("container")},r.destroy=function(){this.get("graph").get("container").removeChild(this.get("container"))},t}(n);e.exports=a},7:function(e,t,r){var n=r(12),o=r(3);e.exports=function(e,t){if(e)if(o(e))for(var r=0,i=e.length;r<i&&!1!==t(e[r],r);r++);else if(n(e))for(var a in e)if(e.hasOwnProperty(a)&&!1===t(e[a],a))break}},8:function(e,t,r){var n=r(2),o=r(7),i=r(17),a=function(){function e(e){this._cfgs=n(this.getDefaultCfgs(),e)}var t=e.prototype;return t.getDefaultCfgs=function(){return{}},t.initPlugin=function(e){var t=this;t.set("graph",e);var r=t.getEvents(),n={};o(r,(function(r,o){var a=i(t,r);n[o]=a,e.on(o,a)})),this._events=n,this.init()},t.init=function(){},t.getEvents=function(){return{}},t.get=function(e){return this._cfgs[e]},t.set=function(e,t){this._cfgs[e]=t},t.destroy=function(){},t.destroyPlugin=function(){this.destroy();var e=this.get("graph"),t=this._events;o(t,(function(t,r){e.off(r,t)})),this._events=null,this._cfgs=null,this.destroyed=!0},e}();e.exports=a},9:function(e,t){e.exports=function(e,t){if(e)for(var r in t)t.hasOwnProperty(r)&&(e.style[r]=t[r]);return e}}})},function(e,t,r){"use strict";var n=r(7);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,a){if(a!==n){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";r.r(t);var n=r(1),o=r.n(n),i=r(2),a=r.n(i),c=r(0),s=r.n(c),u={MODEL_ADD_EDGE:"addEdge",MODEL_ADD_NODE:"addNode",MODEL_EDITE:"edite",MODEL_SHOW:"show",MODEL_BREAK_POINT:"addCPoint",MODEL_MULTI_SELECT:"multiselect",MODEL_SELECT:"select"};function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"graph"in this?Object.defineProperty(this,"graph",{value:null,enumerable:!0,configurable:!0,writable:!0}):this.graph=null}var t,r;return t=e,(r=[{key:"init",value:function(e){this.graph=e}}])&&l(t.prototype,r),e}();function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,o=!1,i=undefined;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(s){o=!0,i=s}finally{try{n||null==c["return"]||c["return"]()}finally{if(o)throw i}}return r}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var h=s.a.Util,y=function(e){var t=e.x,r=e.y;return{centerX:t,centerY:r,minX:t,minY:r,maxX:t,maxY:r,height:0,width:0}},g=function(e,t){return 2*Math.abs(e.centerX-t.centerX)<e.width+t.width&&2*Math.abs(e.centerY-t.centerY)<e.height+t.height},b=function(e){var t=[],r={};return e.forEach((function(e){var t=e.id="".concat(e.x,"-").concat(e.y);r[t]=e})),h.each(r,(function(e){t.push(e)})),t},m=function(e){return b(e)},v=function(e,t){return[e,{x:e.x,y:t.y},t]},E=function(e,t){return 0===e.width&&0===e.height?e:{centerX:e.centerX,centerY:e.centerY,minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t,height:e.height+2*t,width:e.width+2*t}},w=function(e,t){return function(e,t){var r=Math.abs(e.x-t.centerX),n=Math.abs(e.y-t.centerY);return r/t.width>n/t.height}(t,e)?{x:t.x>e.centerX?e.maxX:e.minX,y:t.y}:{x:t.x,y:t.y>e.centerY?e.maxY:e.minY}},x=function(e,t){var r=Math.min(e.minX,t.minX),n=Math.min(e.minY,t.minY),o=Math.max(e.maxX,t.maxX),i=Math.max(e.maxY,t.maxY);return{centerX:(r+o)/2,centerY:(n+i)/2,minX:r,minY:n,maxX:o,maxY:i,height:i-n,width:o-r}},O=function(e){var t=e.minX,r=e.minY,n=e.maxX,o=e.maxY;return[{x:t,y:r},{x:n,y:r},{x:n,y:o},{x:t,y:o}]},S=function(e,t){var r=e.x,n=e.y;return r<t.minX||r>t.maxX||n<t.minY||n>t.maxY},_=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},T=function(e,t,r,n,o){return _(e,t)+_(e,r)+function(e,t){var r=0;return t.forEach((function(t){t&&(e.x===t.x&&(r+=-2),e.y===t.y&&(r+=-2))})),r}(e,[t,r,n,o])},P=function(e,t,r,n){var o=t.x-e.x,i=t.y-e.y,a=n.x-r.x,c=n.y-r.y,s=(-i*(e.x-r.x)+o*(e.y-r.y))/(-a*i+o*c),u=(a*(e.y-r.y)-c*(e.x-r.x))/(-a*i+o*c);return s>=0&&s<=1&&u>=0&&u<=1},M=function(e,t,r){if(r.width===r.height===0)return!1;var n=d(O(r),4),o=n[0],i=n[1],a=n[2],c=n[3];return P(e,t,o,i)||P(e,t,o,c)||P(e,t,i,a)||P(e,t,a,c)},j=function(e,t){var r=[],n=e[0];return r.push("M".concat(n.x," ").concat(n.y)),e.forEach((function(n,o){var i=e[o+1],a=e[o+2];if(i&&a)if(function(e,t,r){return!(e.x===t.x===r.x||e.y===t.y===r.y)}(n,i,a)){var c=d(function(e,t,r,n){var o=_(e,t),i=_(r,t);return o<n&&(n=o),i<n&&(n=i),[{x:t.x-n/o*(t.x-e.x),y:t.y-n/o*(t.y-e.y)},{x:t.x-n/i*(t.x-r.x),y:t.y-n/i*(t.y-r.y)}]}(n,i,a,t),2),s=c[0],u=c[1];r.push("L".concat(s.x," ").concat(s.y)),r.push("Q".concat(i.x," ").concat(i.y," ").concat(u.x," ").concat(u.y)),r.push("L".concat(u.x," ").concat(u.y))}else r.push("L".concat(i.x," ").concat(i.y));else i&&r.push("L".concat(i.x," ").concat(i.y))})),r.join("")},I=function(e,t,r,n,o){var i=r&&r.getBBox()?r.getBBox():y(e),a=n&&n.getBBox()?n.getBBox():y(t);if(g(i,a))return m(v(e,t));var c=E(i,o),s=E(a,o);if(g(c,s))return m(v(e,t));var u=w(c,e),l=w(s,t),f=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[],t=[],r=[];e.forEach((function(e){t.push(e.x),r.push(e.y)}));var n=Math.min.apply(Math,t),o=Math.max.apply(Math,t),i=Math.min.apply(Math,r),a=Math.max.apply(Math,r);return{centerX:(n+o)/2,centerY:(i+a)/2,maxX:o,maxY:a,minX:n,minY:i,height:a-i,width:o-n}}([u,l]),d=(x(c,s),x(c,f)),h=x(s,f),P=[];P=(P=P.concat(O(d))).concat(O(h));var j={x:(e.x+t.x)/2,y:(e.y+t.y)/2};[f,d,h].forEach((function(e){P=P.concat(function(e,t){return function(e,t){return t<e.minX||t>e.maxX?[]:[{x:t,y:e.minY},{x:t,y:e.maxY}]}(e,t.x).concat(function(e,t){return t<e.minY||t>e.maxY?[]:[{x:e.minX,y:t},{x:e.maxX,y:t}]}(e,t.y))}(e,j).filter((function(e){return S(e,c)&&S(e,s)})))})),[{x:u.x,y:l.y},{x:l.x,y:u.y}].forEach((function(e){S(e,c)&&S(e,s)&&P.push(e)})),P.unshift(u),P.push(l);var I=function(e,t,r,n,o,i,a){var c=[],s=[t],u={},l={},f={};l[t.id]=0,f[t.id]=T(t,r,t);var d={};e.forEach((function(e){d[e.id]=e}));for(var h=function(){var p,h,y,g=void 0,m=Infinity;if(s.forEach((function(e){f[e.id]<m&&(m=f[e.id],g=e)})),g===r){var v=[];return function e(t,r,n,o){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;t.unshift(r[o]),n[o]&&n[o]!==o&&i<=100&&e(t,r,n,n[o],i+1)}(v,d,u,r.id),{v:v}}h=g,(y=(p=s).indexOf(h))>-1&&p.splice(y,1),c.push(g),function(e,t,r,n){var o=[];return e.forEach((function(e){e!==t&&(e.x!==t.x&&e.y!==t.y||M(e,t,r)||M(e,t,n)||o.push(e))})),b(o)}(e,g,n,o).forEach((function(e){if(-1===c.indexOf(e)){-1===s.indexOf(e)&&s.push(e);var n=f[g.id]+_(g,e);l[e.id]&&n>=l[e.id]||(u[e.id]=g.id,l[e.id]=n,f[e.id]=l[e.id]+T(e,r,t,i,a))}}))};s.length;){var y=h();if("object"===p(y))return y.v}return[t,r]}(P=b(P),u,l,i,a,e,t);return I.unshift(e),I.push(t),m(I)};function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t,r){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var B=s.a.Util,U=s.a.Global,F="-shape",z="-label",Y=[[0,0],[.25,0],[.5,0],[.75,0],[1,0],[0,.25],[1,.25],[0,.5],[1,.5],[0,.75],[1,.75],[0,1],[.25,1],[.5,1],[.75,1],[1,1]],G=["#FF0000","#FF0000","#FFA500","#FFFF00","#0000FF"],X=function(e){function t(){var e,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,r=k(t).call(this),e=!r||"object"!==C(r)&&"function"!=typeof r?A(this):r,R(A(e),"g6Api",null),R(A(e),"computeLine",(function(t){var r=t.startPoint,n=t.endPoint,o=t.controlPoints,i=0;return o&&o.forEach((function(t){i+=e.lengthStartEnd(r,t),r=t})),i+=e.lengthStartEnd(r,n)})),R(A(e),"lengthStartEnd",(function(e,t){var r=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.sqrt(Math.pow(r,2)+Math.pow(n,2))})),R(A(e),"initTreeGraph",(function(r){N(k(t.prototype),"init",A(e)).call(A(e),r),e.registerTreeEdge(),e.registerTreeNode()})),R(A(e),"baseUrl","./demo/assets/"),R(A(e),"imageType","png"),R(A(e),"multiSelectFilter",[]),R(A(e),"collapsed",!1),R(A(e),"compoutedRate",3),R(A(e),"registerEdge",(function(){s.a.registerEdge("edgeStyle",{options:{stateStyles:{hover:{lineWidth:3},selected:{lineWidth:5}}},draw:function(t,r){var n=t.startPoint,o=t.endPoint;return e.graph.getCurrentMode(),r.addShape("path",{attrs:{stroke:t.selected?"#d3adf7":"#08BD09",lineWidth:4,cursor:"pointer",path:[["M",n.x,n.y],["L",o.x,o.y]]}})},afterDraw:function(t,r){var n=e.graph.getCurrentMode();if(u.MODEL_MULTI_SELECT!=n){var o=r.get("children")[0],i=o.getPoint(0);r.addShape("circle",{attrs:{x:i.x,y:i.y,fill:"#fff",r:2}}).animate({onFrame:function(e){var t=o.getPoint(e);return{x:t.x,y:t.y}},repeat:!0},3e3)}}}),s.a.registerEdge("runedge",{afterDraw:function(t,r){var n=r.get("children")[0],o=n.getPoint(0),i=r.addShape("circle",{attrs:{x:o.x,y:o.y,fill:"#ffffff",r:2}}),a=e.computeLine(t)*e.compoutedRate*5;a<1500&&(a*=5),console.log("cfg----\x3e>%o",a),i.animate({repeat:!0,onFrame:function(e){var t=n.getPoint(e);return{x:t.x,y:t.y}}},a)}},"polyline"),s.a.registerEdge("polyline1",{options:{color:"red",style:{stroke:"red",lineWidth:1,radius:0,offset:5,x:0,y:0},labelCfg:{style:{fill:"#595959"}},stateStyles:{hover:{lineWidth:3},selected:{lineWidth:5}}},shapeType:"polyline",labelPosition:"center",drawShape:function(e,t){var r=this.getShapeStyle(e);return t.addShape("path",{className:"edge-shape",attrs:r})},getShapeStyle:function(e){var t=this.getCustomConfig(e)||{},r=this.options.style,n=t.style,o={stroke:e.color},i=B.deepMix({},r,n,o,e.style);e=this.getPathPoints(e),this.radius=i.radius,this.offset=i.offset;var a=e.startPoint,c=e.endPoint,s=this.getControlPoints(e),u=[a];s&&(u=u.concat(s)),u.push(c);var l=e.sourceNode,f=e.targetNode,p={radius:i.radius};s||(p={source:l,target:f,offset:i.offset,radius:i.radius});var d=this.getPath(u,p);return B.deepMix({},U.defaultEdge.style,i,{lineWidth:e.size},{path:d})},getPath:function(e,t){var r=t.source,n=t.target,o=t.offset,i=t.radius;if(!o){var a=[];return i?a=j(e,i):B.each(e,(function(e,t){0===t?a.push(["M",e.x,e.y]):a.push(["L",e.x,e.y])})),a}if(i){var c=m(I(e[0],e[e.length-1],r,n,o));return j(c,i)}var s=I(e[0],e[e.length-1],r,n,o);return B.pointsToPolygon(s)},update:function(e,t){var r=t.getContainer(),n=this.itemType+F,o=r.findByClassName(n);e.style||(e.style={});var i=o.attr();e.style.radius=e.style.radius||i.radius,e.style.offset=e.style.offset||i.offset;var a=this.getShapeStyle(e);o.attr(a);var c=this.itemType+z,s=r.findByClassName(c);if(e.label)if(s){var u=this.options.labelCfg,l=(this.getCustomConfig(e)||{}).labelCfg,f=B.deepMix({},u,l,e.labelCfg),p=this.getLabelStyle(e,f,r);s.resetMatrix(),s.attr(p)}else this.drawLabel(e,r).set("className",c);else s&&s.remove()}},"single-line")})),R(A(e),"registerNode",(function(){s.a.registerNode("nodeStyle",{afterDraw:function(e,t){if(parseInt(e.alarm)>0){var r=1.2*parseFloat(e.w||60)/2,n=t.addShape("circle",{zIndex:-3,attrs:{x:0,y:0,r:r,fill:G[parseInt(e.alarm)],opacity:.6}}),o=t.addShape("circle",{zIndex:-2,attrs:{x:0,y:0,r:r,fill:G[parseInt(e.alarm)],opacity:.6}}),i=t.addShape("circle",{zIndex:-1,attrs:{x:0,y:0,r:r,fill:G[parseInt(e.alarm)],opacity:.6}});t.sort(),n.animate({r:1.5*r,opacity:.1,repeat:!0},3e3,"easeCubic",null,0),o.animate({r:1.5*r,opacity:.1,repeat:!0},3e3,"easeCubic",null,1e3),i.animate({r:1.5*r,opacity:.1,repeat:!0},3e3,"easeCubic",null,2e3)}},draw:function(t,r){var n=parseFloat(t.w||60),o=parseFloat(t.h||60),i=e.graph.getCurrentMode();t.selected?u.MODEL_MULTI_SELECT==i?r.addShape("image",{attrs:{x:n/2,y:-o/1.2,width:48,height:48,img:e.baseUrl+"ck.svg",cursor:"pointer"}}):u.MODEL_SELECT!=i&&u.MODEL_SHOW!=i&&u.MODEL_BREAK_POINT!=i||r.addShape("rect",{attrs:{x:-n/2-e.selectGap,y:-o/2-e.selectGap,width:n+2*e.selectGap,height:o+2*e.selectGap,stroke:"red"}}):u.MODEL_MULTI_SELECT==i&&r.addShape("image",{attrs:{x:n/2,y:-o/1.2,width:48,height:48,img:e.baseUrl+"uck.svg"}}),t.hasOwnProperty("search")&&t.search&&r.addShape("rect",{attrs:{x:-n/2-e.selectGap,y:-o/2-e.selectGap,width:n+2*e.selectGap,height:o+2*e.selectGap,fill:"red"}}),parseInt(t.alarm);var a=r.addShape("image",{attrs:{x:-n/2,y:-o/2,width:n,height:o,cursor:"pointer",img:e.baseUrl+t.neType+".svg",shadowColor:G[parseInt(t.alarm)],shadowBlur:(parseInt(t.alarm),0),shadowOffsetX:0,shadowOffsetY:0}}),c=14;return t.hasOwnProperty("style")&&t.style.hasOwnProperty("fontSize")&&(c=parseInt(t.style.fontSize)),r.addShape("text",{attrs:{x:0,y:1.1*o,textAlign:"center",text:t.label,fontSize:c,fill:"#00FFFF"}}),a},getAnchorPoints:function(e){return"gd"==e.neType?[]:Y}})})),R(A(e),"registerTreeNode",(function(){s.a.registerNode("treenodeStyle",{afterDraw:function(t,r){var n=t.alarm;if(e.g6Api&&e.g6Api.cacheMap.has(t.id)&&(n=e.g6Api.cacheMap.get(t.id)),parseInt(n)>0){var o=1.2*parseFloat(t.w||30)/2,i=r.addShape("circle",{zIndex:-3,attrs:{x:0,y:0,r:o,fill:G[parseInt(t.alarm)],opacity:.6}}),a=r.addShape("circle",{zIndex:-2,attrs:{x:0,y:0,r:o,fill:G[parseInt(t.alarm)],opacity:.6}}),c=r.addShape("circle",{zIndex:-1,attrs:{x:0,y:0,r:o,fill:G[parseInt(t.alarm)],opacity:.6}});r.sort(),i.animate({r:1.5*o,opacity:.1,repeat:!0},3e3,"easeCubic",null,0),a.animate({r:1.5*o,opacity:.1,repeat:!0},3e3,"easeCubic",null,1e3),c.animate({r:1.5*o,opacity:.1,repeat:!0},3e3,"easeCubic",null,2e3)}},draw:function(t,r){var n=parseFloat(t.w||30),o=parseFloat(t.h||30),i=r.addShape("image",{attrs:{x:-n/2,y:-o/2,width:n,height:o,cursor:"pointer",img:e.baseUrl+t.imageName+"."+e.imageType}}),a=["",40,35,30],c=e.collapsed?["",40,35,30]:a;console.log("cfg.index?levelFont[cfg.index]:12----\x3e>%o,%o,%o",t,c,e.collapsed);var s=t.index?a[t.index]:20;return s||(s=c[3]),r.addShape("text",{attrs:{x:0,y:3==t.index?1.1*o:o,textAlign:"center",text:t.label,fill:"#00FFFF",fontSize:s}}),i}})})),R(A(e),"registerTreeEdge",(function(){s.a.registerEdge("edgeStyle",{draw:function(e,t){var r=e.startPoint,n=e.endPoint,o=t.addShape("path",{attrs:{stroke:"#008000",lineWidth:2,cursor:"pointer",endArrow:e.endArrow,sourceAnchor:null,targetAnchor:null,path:[["M",r.x,r.y],["L",n.x,n.y]]}});return t.addShape("path",{attrs:{stroke:"#008000",lineWidth:2,cursor:"pointer",endArrow:e.endArrow,sourceAnchor:null,targetAnchor:null,path:[["M",n.x,n.y],["L",r.x,r.y]]}}),o},afterDraw:function(e,t){var r=t.get("children")[0],n=r.getPoint(0);t.addShape("circle",{attrs:{x:n.x,y:n.y,fill:"#fff",r:3}}).animate({onFrame:function(e){var t=r.getPoint(e);return{x:t.x,y:t.y}},repeat:!0},3e3)}})})),e.selectGap=5,e}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,e),r=t,(n=[{key:"init",value:function(e){N(k(t.prototype),"init",this).call(this,e),this.registerNode(),this.registerEdge()}}])&&D(r.prototype,n),t}(f),W=function(e,t){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function H(e,t){function r(){this.constructor=e}W(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function Z(e){return"function"==typeof e}var V=!1,K={Promise:undefined,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,V=e},get useDeprecatedSynchronousErrorHandling(){return V}};function q(e){setTimeout((function(){throw e}),0)}var J={closed:!0,next:function(e){},error:function(e){if(K.useDeprecatedSynchronousErrorHandling)throw e;q(e)},complete:function(){}},Q=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}(),$=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),ee=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r,n=this._parentOrParents,o=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var a=0;a<n.length;++a)n[a].remove(this);if(Z(o))try{o.call(this)}catch(u){t=u instanceof $?te(u.errors):[u]}if(Q(i)){a=-1;for(var c=i.length;++a<c;){var s=i[a];if(null!==(r=s)&&"object"==typeof r)try{s.unsubscribe()}catch(u){t=t||[],u instanceof $?t=t.concat(te(u.errors)):t.push(u)}}}if(t)throw new $(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof e){if(o===this)return r;r._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function te(e){return e.reduce((function(e,t){return e.concat(t instanceof $?t.errors:t)}),[])}var re=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),ne=function(e){function t(r,n,o){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=J;break;case 1:if(!r){i.destination=J;break}if("object"==typeof r){r instanceof t?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new oe(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new oe(i,r,n,o)}return i}return H(t,e),t.prototype[re]=function(){return this},t.create=function(e,r,n){var o=new t(e,r,n);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(ee),oe=function(e){function t(t,r,n,o){var i,a=e.call(this)||this;a._parentSubscriber=t;var c=a;return Z(r)?i=r:r&&(i=r.next,n=r.error,o=r.complete,r!==J&&(Z((c=Object.create(r)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(a))),a._context=c,a._next=i,a._error=n,a._complete=o,a}return H(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;K.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=K.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):q(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;q(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};K.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(r){if(this.unsubscribe(),K.useDeprecatedSynchronousErrorHandling)throw r;q(r)}},t.prototype.__tryOrSetError=function(e,t,r){if(!K.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(n){return K.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):(q(n),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(ne),ie=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function ae(){}function ce(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:ae}var se=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,o=function(e,t,r){if(e){if(e instanceof ne)return e;if(e[re])return e[re]()}return e||t||r?new ne(e,t,r):new ne(J)}(e,t,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||K.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),K.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){K.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,r=t.closed,n=t.destination,o=t.isStopped;if(r||o)return!1;e=n&&n instanceof ne?n:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=ue(t))((function(t,n){var o;o=r.subscribe((function(t){try{e(t)}catch(r){n(r),o&&o.unsubscribe()}}),n,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[ie]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:ce(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=ue(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function ue(e){if(e||(e=K.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var le,fe=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),pe=function(e){function t(t,r){var n=e.call(this)||this;return n.subject=t,n.subscriber=r,n.closed=!1,n}return H(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},t}(ee),de=function(e){function t(t){var r=e.call(this,t)||this;return r.destination=t,r}return H(t,e),t}(ne),he=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return H(t,e),t.prototype[re]=function(){return new de(this)},t.prototype.lift=function(e){var t=new ye(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new fe;if(!this.isStopped)for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new fe;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new fe;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++)r[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new fe;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new fe;return this.hasError?(e.error(this.thrownError),ee.EMPTY):this.isStopped?(e.complete(),ee.EMPTY):(this.observers.push(e),new pe(this,e))},t.prototype.asObservable=function(){var e=new se;return e.source=this,e},t.create=function(e,t){return new ye(e,t)},t}(se),ye=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return H(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):ee.EMPTY},t}(he),ge=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new be(e,this.predicate,this.thisArg))},e}(),be=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.predicate=r,o.thisArg=n,o.count=0,o}return H(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}t&&this.destination.next(e)},t}(ne),me=r(3),ve=new he,Ee=new Map,we=(ve.pipe((le=function(e){return!!Ee.has(e.type)},function(e){return e.lift(new ge(le,void 0))})).subscribe((function(e){var t=Ee.get(e.type);t&&t.map((function(t,r){t&&Object(me.isFunction)(t)&&Object(me.has)(e,"data")&&t.call(null,e.data)}))})),function(e,t){var r=[];Ee.has(e)&&(r=Ee.get(e)),-1==r.indexOf(t)&&r.push(t),Ee.set(e,r)}),xe={TOOLBAR_MULTI_SELECT:"TOOLBAR_MULTI_SELECT",TOOLBAR_SINGLE_SELECT:"TOOLBAR_SINGLE_SELECT",TOOLBAR_ADD_NODE:"TOOLBAR_ADD_NODE",TOOLBAR_ADD_EDGE:"TOOLBAR_ADD_EDGE",TOOLBAR_EDITE:"TOOLBAR_EDITE",TOOLBAR_CANCEL_EDITE:"TOOLBAR_CANCEL_EDITE"};function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Se=new function xt(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,xt),Oe(this,"NODE","node_"),Oe(this,"EDGE","edge_"),Oe(this,"CONTROLL","controll_"),Oe(this,"CONTROLL_PRE","&&"),Oe(this,"cacheMap",new Map),Oe(this,"put",(function(t,r){e.cacheMap.set(t,r)})),Oe(this,"get",(function(t){e.cacheMap.get(t)})),Oe(this,"remove",(function(t){e.cacheMap["delete"](t)})),Oe(this,"removeAll",(function(){e.cacheMap.clear()}))};function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t,r){return(Me="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=je(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var De=function(e){function t(){var e,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,r=je(t).call(this),e=!r||"object"!==_e(r)&&"function"!=typeof r?Pe(this):r,Ce(Pe(e),"preSelectNode",null),Ce(Pe(e),"preSelectNodes",[]),Ce(Pe(e),"preSelectEdge",null),Ce(Pe(e),"edge",null),Ce(Pe(e),"addingEdge",!1),Ce(Pe(e),"canvasClickTime",0),Ce(Pe(e),"nodeClickTime",0),Ce(Pe(e),"ctrlKey",!1),Ce(Pe(e),"edgeSelected",null),Ce(Pe(e),"view",null),Ce(Pe(e),"initToolBarEvent",(function(){we(xe.TOOLBAR_MULTI_SELECT,(function(t){t||(e.graph.findAll("node",(function(e){return e.get("model").x})).forEach((function(t){var r=t.getModel();r.selected=!1,e.graph.updateItem(t,r)})),e.preSelectNodes.splice(0))}))})),Ce(Pe(e),"initNodeEvent",(function(){e.graph.on("node:click",(function(t){console.log("initNodeEvent----\x3e>%o",t);var r=t.item.getModel();r.selected=!r.selected,r.hasOwnProperty("search")&&(r.search=0);var n=e.graph.getCurrentMode();if(u.MODEL_MULTI_SELECT==n)if(r.selected)e.preSelectNodes.push(r);else{var o=null;e.preSelectNodes.forEach((function(e,t){e.id==r.id&&(o=t)})),o&&e.preSelectNodes.splice(o,1)}else e.clearSelect(r),e.preSelectNode=t.item;e.graph.updateItem(t.item,r)})),e.graph.on("node:mouseover",(function(e){})),e.graph.on("node:mouseout",(function(e){}))})),Ce(Pe(e),"initEdgeEvent",(function(){e.graph.on("edge:click",(function(t){console.log("initEdgeEvent----\x3e>%o",t);var r=t.item.getModel();r.selected=r.selected?0:1;var n=t.item;e.clearSelect(r),e.preSelectEdge!=n?(e.graph.updateItem(n,r),e.preSelectEdge=n):e.preSelectEdge=null}))})),Ce(Pe(e),"initGlobalEvent",(function(){e.graph.on("canvas:click",(function(t){e.clearSelect(null),e.graph.getNodes().forEach((function(t){var r=t.getModel();r.hasOwnProperty("search")&&(r.search=0,e.graph.updateItem(t,r))}))}))})),Ce(Pe(e),"initBehavior",(function(){s.a.registerBehavior("addCPoint",{getEvents:function(){return{"edge:click":"onEdgeClick","edge:mouseover":"onEdgeMouseOver","edge:mouseout":"onEdgeMouseOut",keydown:"onKeyEventDown",keyup:"onKeyEventUp","canvas:click":"onCanvasClick"}},onEdgeMouseOver:function(e){e.target._attrs.cursor="pointer"},onEdgeMouseOut:function(e){e.target._attrs.cursor="pointer"},onCanvasClick:function(t){var r=e.graph;if(e.edgeSelected&&e.edgeSelected._cfg.states&&r.setItemState(e.edgeSelected,"selected",!1),e.ctrlKey&&e.edgeSelected){var n=s.a.Util.uniqueId(),o={w:20,h:20,shape:"nodeStyle",neType:"gd",label:n,x:t.x,y:t.y,id:n};e.graph.addItem("node",o);var i=e.edgeSelected.getModel(),a=i.source,c=i.target,u="";if(a&&c){var l=e.graph.findById(a).getModel(),f=e.graph.findById(c).getModel();l&&f&&("gd"!=l.neType&&"gd"!=f.neType?u=l.id+Se.CONTROLL_PRE+f.id:i.hasOwnProperty("realNodeId")&&(u=i.realNodeId));var p={source:a,target:n,realNodeId:u,shape:"runedge"},d={source:n,target:c,realNodeId:u,shape:"runedge"},h=[];if(""!=u){Se.cacheMap.has(Se.CONTROLL+u)&&(h=Se.cacheMap.get(Se.CONTROLL+u));var y=-1;h.forEach((function(e,t){e.id==c&&(y=t)})),-1==y?h.push(o):h.splice(y,0,o),Se.cacheMap.set(Se.CONTROLL+u,h)}console.log("controlPoints----\x3e>%o",h),e.graph.addItem("edge",p),e.graph.addItem("edge",d),e.graph.removeItem(e.edgeSelected)}e.edgeSelected=null}},onKeyEventDown:function(t){e.ctrlKey=t.ctrlKey;var r=e.graph;if(46==t.keyCode&&e.preSelectNode){var n=e.preSelectNode,o=n.getModel();if("gd"!=o.neType)return;var i=n.getEdges(),a="",c="",s="";i.forEach((function(e){var t=e.getModel();t.hasOwnProperty("realNodeId")&&(a=t.realNodeId),o.id==t.target&&(c=t.source),o.id==t.source&&(s=t.target)}));var u=[];if(Se.cacheMap.has(Se.CONTROLL+a)){u=Se.cacheMap.get(Se.CONTROLL+a);var l=-1;u.forEach((function(e,t){e.id==o.id&&(l=t)})),-1!=l&&u.splice(l,1),r.removeItem(n),console.log("delete controlPoints----\x3e>%o",u)}var f={source:c,target:s,realNodeId:a,shape:"runedge"};e.graph.addItem("edge",f)}},onKeyEventUp:function(t){e.ctrlKey=t.ctrlKey},onEdgeClick:function(t){var r=e.graph,n=t.item;e.edgeSelected&&e.edgeSelected._cfg&&r.setItemState(e.edgeSelected,"selected",!1),-1!=n._cfg.states.indexOf("selected")?(e.edgeSelected=null,r.setItemState(n,"selected",!1)):(r.setItemState(n,"selected",!0),e.edgeSelected=n),e.view.g6Api.showControll&&(e.view.g6Api.controllPoint(!1),setTimeout((function(){e.view.g6Api.controllPoint(!0)}),500))}}),s.a.registerBehavior("addNode",{getEvents:function(){return{"canvas:click":"onClick"}},onClick:function(e){this.graph.addItem("node",{w:48,h:48,type:"default",shape:"nodeStyle",label:"ellipse",img:"../demo/assets/123.svg",selected:!1,x:e.x,y:e.y,id:s.a.Util.uniqueId()})}}),s.a.registerBehavior("addEdge",{getEvents:function(){return{"node:click":"onClick",mousemove:"onMousemove","edge:click":"onEdgeClick"}},onClick:function(e){console.log("onClick----\x3e>%o",e);var t=e.item,r={x:e.x,y:e.y},n=t.getModel();this.addingEdge&&this.edge?(this.graph.updateItem(this.edge,{target:n.id}),this.edge=null,this.addingEdge=!1):(this.edge=this.graph.addItem("edge",{source:n.id,target:r,shape:"edgeStyle",selected:!1,endArrow:!0}),this.addingEdge=!0)},onMousemove:function(e){var t={x:e.x,y:e.y};this.addingEdge&&this.edge&&this.graph.updateItem(this.edge,{target:t})},onEdgeClick:function(e){var t=e.item;this.addingEdge&&this.edge==t&&(this.graph.removeItem(this.edge),this.edge=null,this.addingEdge=!1)}}),e.graph.addBehaviors("addEdge","addEdge"),e.graph.addBehaviors("addNode","addNode")})),Ce(Pe(e),"changeAnchor",(function(e,t){if(!e.target.isKeyShape){var r=e.target._attrs;r.cursor="crosshair",e.target._cfg,("inner"==r.type?r.outer:e.target).animate({r:t?10:7,repeat:!1},500,"easeCubic",null,0)}})),Ce(Pe(e),"clearSelect",(function(t){if(e.preSelectNode){try{var r=e.preSelectNode.getModel();t&&t.hasOwnProperty("id")?r.selected=r.id==t.id:r.selected=!1,e.graph.updateItem(e.preSelectNode,r)}catch(o){}e.preSelectNode=null}if(e.preSelectEdge){try{var n=e.preSelectEdge.getModel();n.selected=!1,e.graph.updateItem(e.preSelectEdge,n)}catch(o){}e.preSelectEdge=null}})),e}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(t,e),r=t,(n=[{key:"init",value:function(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;Me(je(t.prototype),"init",this).call(this,e),this.view=r,this.graph&&(this.initNodeEvent(),this.initEdgeEvent(),this.initGlobalEvent(),this.initBehavior(),this.initToolBarEvent())}}])&&Te(r.prototype,n),t}(f);function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Be=function(e){function t(){var e,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,r=Le(t).call(this),e=!r||"object"!==Ae(r)&&"function"!=typeof r?Ne(this):r,Re(Ne(e),"onDrag",(function(t){e.graph.setMode(t.model),e.graph.refresh()})),Re(Ne(e),"onEdit",(function(t){e.graph.setMode(t.model),e.graph.refresh()})),Re(Ne(e),"onSelect",(function(t){e.graph.setMode(t.model),e.graph.refresh()})),Re(Ne(e),"onZoomin",(function(t){if(e.graph){var r=e.graph.getZoom();e.graph.zoomTo(r+.5)}})),Re(Ne(e),"onZoomout",(function(t){if(e.graph){var r=e.graph.getZoom();e.graph.zoomTo(r-.5)}})),Re(Ne(e),"onCancel",(function(e){})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(t,e),t}(f);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Xe=["#08BD09","#FF0000","#FFA500","#FFFF00","#0000FF"],We=function(e){function t(){var e,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,r=Fe(t).call(this),e=!r||"object"!==Ue(r)&&"function"!=typeof r?ze(this):r,Ge(ze(e),"preSearch",null),Ge(ze(e),"cacheMap",new Map),Ge(ze(e),"showControll",!1),Ge(ze(e),"getNodes",(function(){})),Ge(ze(e),"getLines",(function(){var t=e.graph.getEdges(),r=[];return console.log("getLines----\x3e>%o",t),t.forEach((function(e){if(console.log("getLines element----\x3e>%o",e),e){var t=e.getModel();r.push(t)}})),r})),Ge(ze(e),"updateDatas",(function(e){})),Ge(ze(e),"clearDatas",(function(){})),Ge(ze(e),"getAllData",(function(){var t=e.graph.getNodes(),r=[];return t.forEach((function(e){var t=e.getModel();r.push(t)})),r})),Ge(ze(e),"addAlarm",(function(t,r,n){console.log("----\x3e>%o,%o",t,r);var o=e.graph.findById(t);if(o){var i=o.getModel();i.alarm=r.toString(),console.log("addAlarm----\x3e>%o",i),e.graph.updateItem(o,i)}else e.cacheMap.set(t,r)})),Ge(ze(e),"addEdgeAlarm",(function(t,r,n){e.graph.getEdges().forEach((function(o){var i=o.getModel();i.source==t&&i.target==r&&(i.style.stroke=Xe[parseInt(n)],console.log("addEdgeAlarm----\x3e>%o",i),e.graph.updateItem(o,i))}))})),Ge(ze(e),"addAlarms",(function(e,t,r){})),Ge(ze(e),"clearAlarm",(function(e,t){})),Ge(ze(e),"clearAlarms",(function(e,t){})),Ge(ze(e),"getSelectsNode",(function(){var t=e.graph.getNodes(),r=[];return t.forEach((function(e){var t=e.getModel();t.selected&&r.push(t)})),r})),Ge(ze(e),"updateSelectNode",(function(e){})),Ge(ze(e),"updateNodeById",(function(t,r){var n=e.graph.findById(t);if(n){var o=n.getModel();Object.assign(o,r),e.graph.updateItem(n,o)}})),Ge(ze(e),"removeNodeById",(function(){})),Ge(ze(e),"removeNodeByIds",(function(e){})),Ge(ze(e),"addNode",(function(e){})),Ge(ze(e),"getNodeById",(function(t){var r=e.graph.findById(t);if(r)return r.getModel()})),Ge(ze(e),"selectNodeById",(function(t){var r=e.graph.findById(t);if(r){if(e.preSearch){var n=e.preSearch.getModel();n.search=0,e.graph.updateItem(e.preSearch,n)}var o=r.getModel();o.search=1,o.selected=1,console.log("selectNodeById----\x3e>%o",o),e.graph.updateItem(r,o),e.preSearch=r}})),Ge(ze(e),"getSelectLine",(function(){var t=e.graph.getEdges(),r=[];return t.forEach((function(e){var t=e.getModel();t.selected&&r.push(t)})),r})),Ge(ze(e),"updateLineStyle",(function(e,t){})),Ge(ze(e),"removeLineById",(function(e){})),Ge(ze(e),"controllPoint",(function(t){if(console.log("showControll----\x3e>%o",t),t){var r=e.graph.getEdges(),n=[],o=[];r.forEach((function(t){var r=t.getModel();if(r.hasOwnProperty("controlPoints")&&r.controlPoints.length>0&&r.hasOwnProperty("selected")&&r.selected){var i=r.controlPoints,a=r.source,c=r.target,u=null,l=[];if(i.forEach((function(t,r){var n=s.a.Util.uniqueId(),o={w:20,h:20,shape:"nodeStyle",neType:"gd",label:n,x:t.x,y:t.y,id:n};l.push(o),e.graph.addItem("node",o)})),l.forEach((function(e,t){var r={source:u?u.id:a,target:e.id,shape:"runedge",realNodeId:a+Se.CONTROLL_PRE+c,style:{stroke:"#08BD09",lineWidth:4,radius:.5,offset:0,lineDash:[]},controlPoints:[]};u=e,n.push(r)})),u){var f={source:u.id,target:c,shape:"runedge",realNodeId:a+Se.CONTROLL_PRE+c,style:{stroke:"#08BD09",lineWidth:4,radius:.5,offset:0,lineDash:[]},controlPoints:[]};u=null,n.push(f)}Se.cacheMap.set(Se.CONTROLL+a+Se.CONTROLL_PRE+c,l),o.push(t)}})),o.forEach((function(t){e.graph.removeItem(t)})),n.forEach((function(t){e.graph.addItem("edge",t)})),setTimeout((function(){e.graph.getEdges().forEach((function(e){e.toFront()})),e.graph.paint()}),500)}else{var i=Se.cacheMap.keys(),a=!0,c=!1,u=undefined;try{for(var l,f=function(){var t=l.value,r=Se.cacheMap.get(t),n=[];r.forEach((function(t,r){var o=e.graph.findById(t.id);if(o){e.graph.removeItem(o);var i={x:t.x,y:t.y};n.push(i)}}));var o=t.replace(Se.CONTROLL,""),i={source:o.split(Se.CONTROLL_PRE)[0],target:o.split(Se.CONTROLL_PRE)[1],shape:"runedge",style:{stroke:"#08BD09",lineWidth:4,radius:.5,offset:0,lineDash:[]},controlPoints:n};Se.cacheMap["delete"](t),e.graph.addItem("edge",i)},p=i[Symbol.iterator]();!(a=(l=p.next()).done);a=!0)f()}catch(d){c=!0,u=d}finally{try{a||null==p["return"]||p["return"]()}finally{if(c)throw u}}}})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(t,e),t}(f),He={click:"Click",contextmenu:"ContextMenu",dblclick:"DoubleClick",drag:"Drag",dragend:"DragEnd",dragenter:"DragEnter",dragleave:"DragLeave",dragstart:"DragStart",drop:"Drop",mousedown:"MouseDown",mouseenter:"MouseEnter",mouseleave:"MouseLeave",mouseover:"MouseMover",mouseup:"MouseUp",mouseout:"MouseOut"},Ze={beforeadditem:"onBeforeadditem",afteradditem:"onAfteradditem",beforeremoveitem:"onBeforeremoveitem",afterremoveitem:"onAfterremoveitem",beforeupdateitem:"onBeforeupdateitem",afterupdateitem:"onAfterupdateitem",beforeitemvisibilitychange:"onBeforeitemvisibilitychange",afteritemvisibilitychange:"onAfteritemvisibilitychange",beforeitemstatechange:"onBeforeitemstatechange",afteritemstatechange:"onAfteritemstatechange",beforeitemrefresh:"onBeforeitemrefresh",afteritemrefresh:"onAfteritemrefresh",beforeitemstatesclear:"onBeforeitemstatesclear",afteritemstatesclear:"onAfteritemstatesclear"},Ve=Object.keys(He),Ke=Object.keys(Ze);function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var rt=function(e){function t(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,n=Qe(t).call(this,e),r=!n||"object"!==qe(n)&&"function"!=typeof n?$e(this):n,tt($e(r),"state",{currentIndex:-1}),tt($e(r),"toolbar",null),tt($e(r),"onIconClick",(function(e,t){var n=-1;e.index!=r.state.currentIndex&&(n=e.index),n=e.index,r.setState({currentIndex:n}),r.toolbar&&r.toolbar["on".concat(e.eventType)](e)})),r.icons=[{name:"拖动",icon:"drag",eventType:"Drag",model:"drag",index:1},{name:"编辑",icon:"edit",eventType:"Edit",model:"edite",index:2},{name:"选择",icon:"select",eventType:"Select",model:"select",index:3},{name:"放大",icon:"zoomin",eventType:"Zoomin",index:4},{name:"缩小",icon:"zoomout",eventType:"Zoomout",index:5},{name:"取消",icon:"cancel",eventType:"Cancel",index:6}],r}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"toolbar-wrap"},this.icons.map((function(t,r){return o.a.createElement("span",{className:"toolbaricon ".concat(e.state.currentIndex==t.index?"toolbaricon-select":"toolbaricon-unselect"),onClick:e.onIconClick.bind(e,t)},o.a.createElement("span",{className:"icon ".concat(t.icon),title:t.name}))})))}}])&&Je(r.prototype,n),t}(o.a.Component),nt=(r(4),r(5)),ot=r.n(nt);function it(e){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pt=function(e){function t(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,n=st(t).call(this,e),r=!n||"object"!==it(n)&&"function"!=typeof n?ut(this):n,ft(ut(r),"state",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?at(Object(r),!0).forEach((function(t){ft(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r.props)),ft(ut(r),"destroy",(function(){r.graph&&(r.graph.stopAnimate(),r.graph.destroy())})),ft(ut(r),"shouldComponentUpdate",(function(e,t){var n=!1;return Object.keys(e).forEach((function(t){r.props.hasOwnProperty(t)&&e[t]!=r.props[t]&&(n=!0)})),r.props.datas!=e.datas&&r.graph&&r.setData(e.datas,!0),r.props.model!=e.model&&r.graph.setMode(e.model),n})),ft(ut(r),"setData",(function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],n=r.topoWrap.getBoundingClientRect(),o=0;if(e.nodes.forEach((function(e){var t=parseInt(e.y);t>o&&(o=t)})),t&&r.graph.clear(),r.state.userLayout){var i=e.nodes.length,a=n.width/(i+1);e.nodes.forEach((function(e,t){var r=t%2==0?100:0;e.x=a*(t+1),e.y=n.height/3+r}))}r.state.fitView||r.graph.changeSize(r.sourceRect.width,o>r.sourceRect.height?1.05*o:r.sourceRect.height),r.graph.data(e),r.graph.render(),r.state.fitView&&r.graph.fitView(r.state.fitGap)})),ft(ut(r),"componentWillUnmount",(function(){})),ft(ut(r),"initUtil",(function(){r.g6Api.init(r.graph),r.toolbarUtil.init(r.graph),r.graphEventUtil.init(r.graph,ut(r)),r.registerUtil.init(r.graph),r.registerUtil.baseUrl=r.state.baseUrl,r.initResizeEvent()})),ft(ut(r),"initResizeEvent",(function(){})),ft(ut(r),"resize",(function(){clearTimeout(r.resizeTimer),r.resizeTimer=setTimeout((function(){}),500)})),ft(ut(r),"addListener",(function(e,t,r){"function"==typeof r&&e.on(t,r)})),r.graph=null,r.registerUtil=new X,r.graphEventUtil=new De,r.toolbarUtil=new Be,r.cacheUtil=Se,r.g6Api=new We,r.resizeTimer=0,r.ctrlKey=!1,r.sourceRect={width:0,height:0,left:0,top:0,datas:[]},r}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.topoWrap.getBoundingClientRect();new ot.a,t&&(this.graph=new s.a.Graph({container:this.props.el,width:t.width,renderer:"canvas",height:t.height-4,fitView:this.state.fitView,pixeRatio:1,autoPaint:!1,groupByTypes:!1,defaultEdge:{shape:"runedge",style:{lineWidth:4,stroke:"#08BD09",radius:20,offset:0}},edgeStateStyles:{selected:{stroke:"#d3adf7",lineWidth:4,lineDash:[]}},modes:{"default":[{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],addCPoint:["addCPoint","drag-node","zoom-canvas"],addEdge:["addEdge","drag-node",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],addNode:["addNode","drag-node",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],edite:["drag-node","addEdge","addNode",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return"text"===e.target.type}}],show:["drag-canvas","zoom-canvas",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return"text"===e.target.type}}],multiselect:["drag-node","drag-canvas","click-select","zoom-canvas",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(t){return"text"===t.target.type&&!!e.ctrlKey}}],select:["drag-node",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],drag:["drag-canvas",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return"text"===e.target.type}}]}}),this.sourceRect={width:t.width,height:t.height,datas:this.state.datas},this.initUtil(),this.initEvent(),this.toolbar&&(this.toolbar.toolbar=this.toolbarUtil),this.graph.setMode(this.state.model),this.setData(this.state.datas),this.graph.render(),setTimeout((function(){e.graph.getEdges().forEach((function(e){e.toFront()})),e.graph.paint()}),500)),document.onkeydown=function(t){e.ctrlKey=t.ctrlKey},document.onkeyup=function(t){e.ctrlKey=t.ctrlKey}}},{key:"initEvent",value:function(){var e=this,t=this.addListener;Ve.forEach((function(r){var n=He[r];t(e.graph,"node:".concat(r),e.props["onNode".concat(n)]),t(e.graph,"edge:".concat(r),e.props["onEdge".concat(n)]),t(e.graph,"canvas:".concat(r),e.props["onCanvas".concat(n)])})),Ke.forEach((function(r){t(e.page,[r],e.props[Ze[r]])}))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"topowrap",ref:function(t){e.topoWrap=t}},o.a.createElement("div",{className:"topo-content",id:this.props.el}),this.state.showToolBar?o.a.createElement(rt,{ref:function(t){e.toolbar=t}}):null)}}])&&ct(r.prototype,n),t}(o.a.Component);function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gt(e){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mt(e,t){return(mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ft(pt,"defaultProps",{el:"topoEl",datas:[],baseUrl:"../demo/assets/",model:"addCPoint",nodeMenu:[],edgeMenu:[],multiSelectFilter:[],showToolBar:!0,fitView:!0,moveCenter:!1,userLayout:!1,fitGap:100}),ft(pt,"propTypes",{el:a.a.string.isRequired,datas:a.a.array.isRequired});var Et=function(e){function t(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,n=gt(t).call(this,e),r=!n||"object"!==dt(n)&&"function"!=typeof n?bt(this):n,vt(bt(r),"state",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){vt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r.props)),vt(bt(r),"destroy",(function(){r.graph&&(r.g6Api.cacheMap.clear(),r.graph.stopAnimate(),r.graph.destroy())})),vt(bt(r),"clear",(function(){r.graph&&(r.g6Api.cacheMap.clear(),r.graph.stopAnimate(),r.graph.clear())})),vt(bt(r),"shouldComponentUpdate",(function(e,t){var n=!1;return Object.keys(e).forEach((function(t){r.props.hasOwnProperty(t)&&e[t]!=r.props[t]&&(n=!0)})),r.props.datas!=e.datas&&(r.topoWrap.getBoundingClientRect(),r.graph&&(r.graph.clear(),r.graph.changeData(e.datas))),n})),vt(bt(r),"componentWillUnmount",(function(){window.removeEventListener("resize",r.resize)})),vt(bt(r),"initResizeEvent",(function(){window.addEventListener("resize",r.resize)})),vt(bt(r),"resize",(function(){clearTimeout(r.resizeTimer),r.resizeTimer=setTimeout((function(){}),500)})),vt(bt(r),"addListener",(function(e,t,r){"function"==typeof r&&e.on(t,r)})),r.graph=null,r.g6Api=new We,r.registerUtil=new X,r.preZoom=1,r.sourceRect={width:0,height:0,left:0,top:0,datas:[]},r.levelColos=["#FF0000","#FF0000","#FFA500","#FFFF00","#0000FF"],r}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mt(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.topoWrap.getBoundingClientRect();if(t){var r={dendrogram:{type:"dendrogram",direction:"TB",nodeSep:this.state.nodeSep,rankSep:this.state.rankSep,radial:this.state.radial}};this.graph=new s.a.TreeGraph({container:this.props.el,width:t.width,height:t.height-4,pixelRatio:2,modes:{"default":["drag-canvas","zoom-canvas",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return"text"===e.target.type}}]},fitView:!0,animate:!0,linkCenter:!1,layout:r.dendrogram});var n=this.state.datas;this.registerUtil.baseUrl=this.state.baseUrl,this.g6Api.init(this.graph),this.registerUtil.initTreeGraph(this.graph),this.registerUtil.g6Api=this.g6Api,this.graph.node((function(t){return{shape:"treenodeStyle",label:t.name,size:[t.w,t.h],id:t.id,img:e.state.baseUrl+t.imageName+"."+e.state.imageType,style:{cursor:"pointer"},labelCfg:{position:"bottom",style:{fill:"#00FFFF",fontSize:20}}}})),this.graph.edge((function(){return{color:"#fcfdfd",label:"",shape:"edgeStyle"}})),this.initEvent(),this.graph.data(n),this.graph.render()}}},{key:"initEvent",value:function(){var e=this,t=this.addListener;Ve.forEach((function(r){var n=He[r];t(e.graph,"node:".concat(r),e.props["onNode".concat(n)]),t(e.graph,"edge:".concat(r),e.props["onEdge".concat(n)]),t(e.graph,"canvas:".concat(r),e.props["onCanvas".concat(n)])})),Ke.forEach((function(r){t(e.page,[r],e.props[Ze[r]])}))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"topowrap",ref:function(t){e.topoWrap=t}},o.a.createElement("div",{className:"topo-content",id:this.props.el}))}}])&&yt(r.prototype,n),t}(o.a.Component);vt(Et,"defaultProps",{el:"topoEl",datas:[],baseUrl:"./demo/assets/",model:"multiselect",imageType:"png",nodeMenu:[],edgeMenu:[],showToolBar:!0,nodeSep:300,rankSep:400,radial:!1}),vt(Et,"propTypes",{el:a.a.string.isRequired,datas:a.a.array.isRequired});var wt={version:"1.0",author:"maixing",TopoView:pt,TreeTopoView:Et,EventBus:undefined,EventConsts:undefined};t["default"]=wt}])}));