!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("@antv/g6"),require("lodash")):"function"==typeof define&&define.amd?define(["react","@antv/g6","lodash"],t):"object"==typeof exports?exports["g6lib.min.js"]=t(require("react"),require("@antv/g6"),require("lodash")):e["g6lib.min.js"]=t(e.React,e["@antv/g6"],e.lodash)}(window,(function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){e.exports=r(5)()},function(e,t){e.exports=r},function(e,t,r){},function(e,t,r){"use strict";var n=r(6);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,a){if(a!==n){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),i=r(2),a=r.n(i),c=r(1),s=r.n(c),u={MODEL_ADD_EDGE:"addEdge",MODEL_ADD_NODE:"addNode",MODEL_EDITE:"edite",MODEL_SHOW:"show",MODEL_MULTI_SELECT:"multiselect",MODEL_SELECT:"select"};function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"graph"in this?Object.defineProperty(this,"graph",{value:null,enumerable:!0,configurable:!0,writable:!0}):this.graph=null}var t,r;return t=e,(r=[{key:"init",value:function(e){this.graph=e}}])&&l(t.prototype,r),e}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,r){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=[[0,0],[.5,0],[1,0],[0,.5],[1,.5],[0,1],[.5,1],[1,1]],E=["#FF0000","#FF0000","#FFA500","#FFFF00","#0000FF"],w=function(e){function t(){var e,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,r=g(t).call(this),e=!r||"object"!==f(r)&&"function"!=typeof r?d(this):r,m(d(e),"g6Api",null),m(d(e),"initTreeGraph",(function(r){b(g(t.prototype),"init",d(e)).call(d(e),r),e.registerTreeEdge(),e.registerTreeNode()})),m(d(e),"baseUrl","./demo/assets/"),m(d(e),"imageType","png"),m(d(e),"multiSelectFilter",[]),m(d(e),"collapsed",!1),m(d(e),"registerEdge",(function(){s.a.registerEdge("edgeStyle",{draw:function(t,r){var n=t.startPoint,o=t.endPoint,i="#008000";return e.graph.getCurrentMode()==u.MODEL_SELECT&&t.selected&&(i="blue"),r.addShape("path",{attrs:{stroke:i,lineWidth:2,cursor:"pointer",endArrow:t.endArrow,path:[["M",n.x,n.y],["L",o.x,o.y]]}})},afterDraw:function(t,r){var n=e.graph.getCurrentMode();if(u.MODEL_MULTI_SELECT!=n){var o=r.get("children")[0],i=o.getPoint(0);r.addShape("circle",{attrs:{x:i.x,y:i.y,fill:"#fff",r:3}}).animate({onFrame:function(e){var t=o.getPoint(e);return{x:t.x,y:t.y}},repeat:!0},3e3)}}})})),m(d(e),"registerNode",(function(){s.a.registerNode("nodeStyle",{afterDraw:function(e,t){if(parseInt(e.alarm)>0){var r=1.2*parseFloat(e.w)/2,n=t.addShape("circle",{zIndex:-3,attrs:{x:0,y:0,r:r,fill:E[parseInt(e.alarm)],opacity:.6}}),o=t.addShape("circle",{zIndex:-2,attrs:{x:0,y:0,r:r,fill:E[parseInt(e.alarm)],opacity:.6}}),i=t.addShape("circle",{zIndex:-1,attrs:{x:0,y:0,r:r,fill:E[parseInt(e.alarm)],opacity:.6}});t.sort(),n.animate({r:1.5*r,opacity:.1,repeat:!0},3e3,"easeCubic",null,0),o.animate({r:1.5*r,opacity:.1,repeat:!0},3e3,"easeCubic",null,1e3),i.animate({r:1.5*r,opacity:.1,repeat:!0},3e3,"easeCubic",null,2e3)}},draw:function(t,r){var n=parseFloat(t.w),o=parseFloat(t.h),i=e.graph.getCurrentMode();t.selected?u.MODEL_MULTI_SELECT==i?r.addShape("image",{attrs:{x:n/2,y:-o/1.2,width:48,height:48,img:e.baseUrl+"ck.svg",cursor:"pointer"}}):u.MODEL_SELECT!=i&&u.MODEL_SHOW!=i||r.addShape("rect",{attrs:{x:-n/2-e.selectGap,y:-o/2-e.selectGap,width:n+2*e.selectGap,height:o+2*e.selectGap,stroke:"red"}}):u.MODEL_MULTI_SELECT==i&&r.addShape("image",{attrs:{x:n/2,y:-o/1.2,width:48,height:48,img:e.baseUrl+"uck.svg"}}),parseInt(t.alarm);var a=r.addShape("image",{attrs:{x:-n/2,y:-o/2,width:n,height:o,cursor:"pointer",img:e.baseUrl+t.neType+".svg",shadowColor:E[parseInt(t.alarm)],shadowBlur:(parseInt(t.alarm),0),shadowOffsetX:0,shadowOffsetY:0}});return r.addShape("text",{attrs:{x:0,y:1.1*o,textAlign:"center",text:t.label,fontSize:14,fill:"#00FFFF"}}),a},getAnchorPoints:function(e){return v}})})),m(d(e),"registerTreeNode",(function(){s.a.registerNode("treenodeStyle",{afterDraw:function(t,r){var n=t.alarm;if(e.g6Api&&e.g6Api.cacheMap.has(t.id)&&(n=e.g6Api.cacheMap.get(t.id)),parseInt(n)>0){var o=1.2*parseFloat(t.w||30)/2,i=r.addShape("circle",{zIndex:-3,attrs:{x:0,y:0,r:o,fill:E[parseInt(t.alarm)],opacity:.6}}),a=r.addShape("circle",{zIndex:-2,attrs:{x:0,y:0,r:o,fill:E[parseInt(t.alarm)],opacity:.6}}),c=r.addShape("circle",{zIndex:-1,attrs:{x:0,y:0,r:o,fill:E[parseInt(t.alarm)],opacity:.6}});r.sort(),i.animate({r:1.5*o,opacity:.1,repeat:!0},3e3,"easeCubic",null,0),a.animate({r:1.5*o,opacity:.1,repeat:!0},3e3,"easeCubic",null,1e3),c.animate({r:1.5*o,opacity:.1,repeat:!0},3e3,"easeCubic",null,2e3)}},draw:function(t,r){var n=parseFloat(t.w||30),o=parseFloat(t.h||30),i=r.addShape("image",{attrs:{x:-n/2,y:-o/2,width:n,height:o,cursor:"pointer",img:e.baseUrl+t.imageName+"."+e.imageType}}),a=["",40,35,25],c=e.collapsed?["",70,60,50]:a;console.log("cfg.index?levelFont[cfg.index]:12----\x3e>%o,%o,%o",t,c,e.collapsed);var s=t.index?a[t.index]:12;return s||(s=c[3]),r.addShape("text",{attrs:{x:0,y:o,textAlign:"center",text:t.label,fill:"#00FFFF",fontSize:s}}),i}})})),m(d(e),"registerTreeEdge",(function(){s.a.registerEdge("edgeStyle",{draw:function(e,t){var r=e.startPoint,n=e.endPoint,o=t.addShape("path",{attrs:{stroke:"#008000",lineWidth:2,cursor:"pointer",endArrow:e.endArrow,sourceAnchor:null,targetAnchor:null,path:[["M",r.x,r.y],["L",n.x,n.y]]}});return t.addShape("path",{attrs:{stroke:"#008000",lineWidth:2,cursor:"pointer",endArrow:e.endArrow,sourceAnchor:null,targetAnchor:null,path:[["M",n.x,n.y],["L",r.x,r.y]]}}),o},afterDraw:function(e,t){var r=t.get("children")[0],n=r.getPoint(0);t.addShape("circle",{attrs:{x:n.x,y:n.y,fill:"#fff",r:3}}).animate({onFrame:function(e){var t=r.getPoint(e);return{x:t.x,y:t.y}},repeat:!0},3e3)}})})),e.selectGap=5,e}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),r=t,(n=[{key:"init",value:function(e){b(g(t.prototype),"init",this).call(this,e),this.registerNode(),this.registerEdge()}}])&&h(r.prototype,n),t}(p),O=function(e,t){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function _(e,t){function r(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function S(e){return"function"==typeof e}var T=!1,x={Promise:undefined,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,T=e},get useDeprecatedSynchronousErrorHandling(){return T}};function j(e){setTimeout((function(){throw e}),0)}var P={closed:!0,next:function(e){},error:function(e){if(x.useDeprecatedSynchronousErrorHandling)throw e;j(e)},complete:function(){}},D=Array.isArray||function(e){return e&&"number"==typeof e.length};function M(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}M.prototype=Object.create(Error.prototype);var A=M,L=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r,n=this._parentOrParents,o=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var a=0;a<n.length;++a)n[a].remove(this);if(S(o))try{o.call(this)}catch(u){t=u instanceof A?C(u.errors):[u]}if(D(i)){a=-1;for(var c=i.length;++a<c;){var s=i[a];if(null!==(r=s)&&"object"==typeof r)try{s.unsubscribe()}catch(u){t=t||[],u instanceof A?t=t.concat(C(u.errors)):t.push(u)}}}if(t)throw new A(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof e){if(o===this)return r;r._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function C(e){return e.reduce((function(e,t){return e.concat(t instanceof A?t.errors:t)}),[])}var k="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),I=function(e){function t(r,n,o){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=P;break;case 1:if(!r){i.destination=P;break}if("object"==typeof r){r instanceof t?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new U(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new U(i,r,n,o)}return i}return _(t,e),t.prototype[k]=function(){return this},t.create=function(e,r,n){var o=new t(e,r,n);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(L),U=function(e){function t(t,r,n,o){var i,a=e.call(this)||this;a._parentSubscriber=t;var c=a;return S(r)?i=r:r&&(i=r.next,n=r.error,o=r.complete,r!==P&&(S((c=Object.create(r)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(a))),a._context=c,a._next=i,a._error=n,a._complete=o,a}return _(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;x.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=x.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):j(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;j(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};x.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(r){if(this.unsubscribe(),x.useDeprecatedSynchronousErrorHandling)throw r;j(r)}},t.prototype.__tryOrSetError=function(e,t,r){if(!x.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(n){return x.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):(j(n),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(I),N="function"==typeof Symbol&&Symbol.observable||"@@observable";function R(){}function F(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:R}var B=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,o=function(e,t,r){if(e){if(e instanceof I)return e;if(e[k])return e[k]()}return e||t||r?new I(e,t,r):new I(P)}(e,t,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||x.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),x.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){x.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,r=t.closed,n=t.destination,o=t.isStopped;if(r||o)return!1;e=n&&n instanceof I?n:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=z(t))((function(t,n){var o;o=r.subscribe((function(t){try{e(t)}catch(r){n(r),o&&o.unsubscribe()}}),n,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[N]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:F(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=z(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function z(e){if(e||(e=x.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function G(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}G.prototype=Object.create(Error.prototype);var W,H=G,V=function(e){function t(t,r){var n=e.call(this)||this;return n.subject=t,n.subscriber=r,n.closed=!1,n}return _(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},t}(L),q=function(e){function t(t){var r=e.call(this,t)||this;return r.destination=t,r}return _(t,e),t}(I),Z=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return _(t,e),t.prototype[k]=function(){return new q(this)},t.prototype.lift=function(e){var t=new K(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new H;if(!this.isStopped)for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new H;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new H;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++)r[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new H;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new H;return this.hasError?(e.error(this.thrownError),L.EMPTY):this.isStopped?(e.complete(),L.EMPTY):(this.observers.push(e),new V(this,e))},t.prototype.asObservable=function(){var e=new B;return e.source=this,e},t.create=function(e,t){return new K(e,t)},t}(B),K=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return _(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):L.EMPTY},t}(Z),Y=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new X(e,this.predicate,this.thisArg))},e}(),X=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.predicate=r,o.thisArg=n,o.count=0,o}return _(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}t&&this.destination.next(e)},t}(I),J=r(3),Q=new Z,$=new Map,ee=(Q.pipe((W=function(e){return!!$.has(e.type)},function(e){return e.lift(new Y(W,void 0))})).subscribe((function(e){var t=$.get(e.type);t&&t.map((function(t,r){t&&Object(J.isFunction)(t)&&Object(J.has)(e,"data")&&t.call(null,e.data)}))})),function(e,t){var r=[];$.has(e)&&(r=$.get(e)),-1==r.indexOf(t)&&r.push(t),$.set(e,r)}),te={TOOLBAR_MULTI_SELECT:"TOOLBAR_MULTI_SELECT",TOOLBAR_SINGLE_SELECT:"TOOLBAR_SINGLE_SELECT",TOOLBAR_ADD_NODE:"TOOLBAR_ADD_NODE",TOOLBAR_ADD_EDGE:"TOOLBAR_ADD_EDGE",TOOLBAR_EDITE:"TOOLBAR_EDITE",TOOLBAR_CANCEL_EDITE:"TOOLBAR_CANCEL_EDITE"};function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e,t,r){return(ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ae(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ue=function(e){function t(){var e,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,r=ae(t).call(this),e=!r||"object"!==re(r)&&"function"!=typeof r?oe(this):r,se(oe(e),"preSelectNode",null),se(oe(e),"preSelectNodes",[]),se(oe(e),"preSelectEdge",null),se(oe(e),"edge",null),se(oe(e),"addingEdge",!1),se(oe(e),"initToolBarEvent",(function(){ee(te.TOOLBAR_MULTI_SELECT,(function(t){t||(e.graph.findAll("node",(function(e){return e.get("model").x})).forEach((function(t){var r=t.getModel();r.selected=!1,e.graph.updateItem(t,r)})),e.preSelectNodes.splice(0))}))})),se(oe(e),"initNodeEvent",(function(){e.graph.on("node:click",(function(t){var r=t.item.getModel();r.selected=!r.selected;var n=e.graph.getCurrentMode();if(u.MODEL_MULTI_SELECT==n)if(r.selected)e.preSelectNodes.push(r);else{var o=null;e.preSelectNodes.forEach((function(e,t){e.id==r.id&&(o=t)})),o&&e.preSelectNodes.splice(o,1)}else e.clearSelect(r),e.preSelectNode=t.item;e.graph.updateItem(t.item,r)})),e.graph.on("node:mouseover",(function(e){})),e.graph.on("node:mouseout",(function(e){}))})),se(oe(e),"initEdgeEvent",(function(){e.graph.on("edge:click",(function(t){var r=t.item.getModel();r.selected=r.selected?0:1;var n=t.item;e.clearSelect(),e.preSelectEdge!=n?(e.graph.updateItem(n,r),e.preSelectEdge=n):e.preSelectEdge=null}))})),se(oe(e),"initGlobalEvent",(function(){e.graph.on("canvas:click",(function(t){e.clearSelect()}))})),se(oe(e),"initBehavior",(function(){console.log("initBehavior----\x3e>%o"),s.a.registerBehavior("addNode",{getEvents:function(){return{"canvas:click":"onClick"}},onClick:function(e){this.graph.addItem("node",{w:48,h:48,type:"default",shape:"nodeStyle",label:"ellipse",img:"../demo/assets/123.svg",selected:!1,x:e.x,y:e.y,id:s.a.Util.uniqueId()})}}),s.a.registerBehavior("addEdge",{getEvents:function(){return{"node:click":"onClick",mousemove:"onMousemove","edge:click":"onEdgeClick"}},onClick:function(e){console.log("onClick----\x3e>%o",e);var t=e.item,r={x:e.x,y:e.y},n=t.getModel();this.addingEdge&&this.edge?(this.graph.updateItem(this.edge,{target:n.id}),this.edge=null,this.addingEdge=!1):(this.edge=this.graph.addItem("edge",{source:n.id,target:r,shape:"edgeStyle",selected:!1,endArrow:!0}),this.addingEdge=!0)},onMousemove:function(e){var t={x:e.x,y:e.y};this.addingEdge&&this.edge&&this.graph.updateItem(this.edge,{target:t})},onEdgeClick:function(e){var t=e.item;this.addingEdge&&this.edge==t&&(this.graph.removeItem(this.edge),this.edge=null,this.addingEdge=!1)}}),e.graph.addBehaviors("addEdge","addEdge"),e.graph.addBehaviors("addNode","addNode")})),se(oe(e),"changeAnchor",(function(e,t){if(!e.target.isKeyShape){var r=e.target._attrs;r.cursor="crosshair",e.target._cfg,("inner"==r.type?r.outer:e.target).animate({r:t?10:7,repeat:!1},500,"easeCubic",null,0)}})),se(oe(e),"clearSelect",(function(t){if(e.preSelectNode){var r=e.preSelectNode.getModel();r.selected=r.id==t.id,e.graph.updateItem(e.preSelectNode,r),e.preSelectNode=null}if(e.preSelectEdge){var n=e.preSelectEdge.getModel();n.selected=!1,e.graph.updateItem(e.preSelectEdge,n),e.preSelectEdge=null}})),e}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(t,e),r=t,(n=[{key:"init",value:function(e){ie(ae(t.prototype),"init",this).call(this,e),this.graph&&(this.initNodeEvent(),this.initEdgeEvent(),this.initGlobalEvent(),this.initBehavior(),this.initToolBarEvent())}}])&&ne(r.prototype,n),t}(p);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ye=function(e){function t(){var e,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,r=pe(t).call(this),e=!r||"object"!==le(r)&&"function"!=typeof r?fe(this):r,de(fe(e),"onDrag",(function(t){e.graph.setMode(t.model),e.graph.refresh()})),de(fe(e),"onEdit",(function(t){e.graph.setMode(t.model),e.graph.refresh()})),de(fe(e),"onSelect",(function(t){e.graph.setMode(t.model),e.graph.refresh()})),de(fe(e),"onZoomin",(function(t){if(e.graph){var r=e.graph.getZoom();e.graph.zoomTo(r+.5)}})),de(fe(e),"onZoomout",(function(t){if(e.graph){var r=e.graph.getZoom();e.graph.zoomTo(r-.5)}})),de(fe(e),"onCancel",(function(e){})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(t,e),t}(p);function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ve(e,t){return(ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var we=function(e){function t(){var e,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,r=ge(t).call(this),e=!r||"object"!==be(r)&&"function"!=typeof r?me(this):r,Ee(me(e),"cacheMap",new Map),Ee(me(e),"getNodes",(function(){})),Ee(me(e),"getLines",(function(){var t=e.graph.getEdges(),r=[];return t.forEach((function(e){var t=e.getModel();r.push(t)})),r})),Ee(me(e),"updateDatas",(function(e){})),Ee(me(e),"clearDatas",(function(){})),Ee(me(e),"getAllData",(function(){var t=e.graph.getNodes(),r=[];return t.forEach((function(e){var t=e.getModel();r.push(t)})),r})),Ee(me(e),"addAlarm",(function(t,r,n){console.log("----\x3e>%o,%o",t,r);var o=e.graph.findById(t);if(o){var i=o.getModel();i.alarm=r.toString(),console.log("addAlarm----\x3e>%o",i),e.graph.updateItem(o,i)}else e.cacheMap.set(t,r)})),Ee(me(e),"addAlarms",(function(e,t,r){})),Ee(me(e),"clearAlarm",(function(e,t){})),Ee(me(e),"clearAlarms",(function(e,t){})),Ee(me(e),"getSelectsNode",(function(){var t=e.graph.getNodes(),r=[];return t.forEach((function(e){var t=e.getModel();t.selected&&r.push(t)})),r})),Ee(me(e),"updateSelectNode",(function(e){})),Ee(me(e),"updateNodeById",(function(e,t){})),Ee(me(e),"removeNodeById",(function(){})),Ee(me(e),"removeNodeByIds",(function(e){})),Ee(me(e),"addNode",(function(e){})),Ee(me(e),"getNodeById",(function(t){var r=e.graph.findById(t);if(r)return r.getModel()})),Ee(me(e),"getSelectLine",(function(){var t=e.graph.getEdges(),r=[];return t.forEach((function(e){var t=e.getModel();t.selected&&r.push(t)})),r})),Ee(me(e),"updateLineStyle",(function(e,t){})),Ee(me(e),"removeLineById",(function(e){})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ve(e,t)}(t,e),t}(p),Oe={click:"Click",contextmenu:"ContextMenu",dblclick:"DoubleClick",drag:"Drag",dragend:"DragEnd",dragenter:"DragEnter",dragleave:"DragLeave",dragstart:"DragStart",drop:"Drop",mousedown:"MouseDown",mouseenter:"MouseEnter",mouseleave:"MouseLeave",mouseover:"MouseMover",mouseup:"MouseUp",mouseout:"MouseOut"},_e={beforeadditem:"onBeforeadditem",afteradditem:"onAfteradditem",beforeremoveitem:"onBeforeremoveitem",afterremoveitem:"onAfterremoveitem",beforeupdateitem:"onBeforeupdateitem",afterupdateitem:"onAfterupdateitem",beforeitemvisibilitychange:"onBeforeitemvisibilitychange",afteritemvisibilitychange:"onAfteritemvisibilitychange",beforeitemstatechange:"onBeforeitemstatechange",afteritemstatechange:"onAfteritemstatechange",beforeitemrefresh:"onBeforeitemrefresh",afteritemrefresh:"onAfteritemrefresh",beforeitemstatesclear:"onBeforeitemstatesclear",afteritemstatesclear:"onAfteritemstatesclear"},Se=Object.keys(Oe),Te=Object.keys(_e);function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function De(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Le=function(e){function t(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,n=Pe(t).call(this,e),r=!n||"object"!==xe(n)&&"function"!=typeof n?De(this):n,Ae(De(r),"state",{currentIndex:-1}),Ae(De(r),"toolbar",null),Ae(De(r),"onIconClick",(function(e,t){var n=-1;e.index!=r.state.currentIndex&&(n=e.index),n=e.index,r.setState({currentIndex:n}),r.toolbar&&r.toolbar["on".concat(e.eventType)](e)})),r.icons=[{name:"拖动",icon:"drag",eventType:"Drag",model:"drag",index:1},{name:"编辑",icon:"edit",eventType:"Edit",model:"edite",index:2},{name:"选择",icon:"select",eventType:"Select",model:"select",index:3},{name:"放大",icon:"zoomin",eventType:"Zoomin",index:4},{name:"缩小",icon:"zoomout",eventType:"Zoomout",index:5},{name:"取消",icon:"cancel",eventType:"Cancel",index:6}],r}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"toolbar-wrap"},this.icons.map((function(t,r){return o.a.createElement("span",{className:"toolbaricon ".concat(e.state.currentIndex==t.index?"toolbaricon-select":"toolbaricon-unselect"),onClick:e.onIconClick.bind(e,t)},o.a.createElement("span",{className:"icon ".concat(t.icon),title:t.name}))})))}}])&&je(r.prototype,n),t}(o.a.Component);function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(4);var Be=function(e){function t(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,n=Ue(t).call(this,e),r=!n||"object"!==Ce(n)&&"function"!=typeof n?Ne(this):n,Fe(Ne(r),"state",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ke(r,!0).forEach((function(t){Fe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ke(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r.props)),Fe(Ne(r),"destroy",(function(){r.graph&&(r.graph.stopAnimate(),r.graph.destroy())})),Fe(Ne(r),"shouldComponentUpdate",(function(e,t){var n=!1;return Object.keys(e).forEach((function(t){r.props.hasOwnProperty(t)&&e[t]!=r.props[t]&&(n=!0)})),r.props.datas!=e.datas&&r.graph&&r.setData(e.datas,!0),n})),Fe(Ne(r),"setData",(function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],n=r.topoWrap.getBoundingClientRect(),o=0;if(e.nodes.forEach((function(e){var t=parseInt(e.y);t>o&&(o=t)})),t&&r.graph.clear(),r.state.userLayout){var i=e.nodes.length,a=n.width/(i+1);e.nodes.forEach((function(e,t){e.x=a*(t+1),e.y=n.height/3}))}r.state.fitView||r.graph.changeSize(r.sourceRect.width,o>r.sourceRect.height?1.05*o:r.sourceRect.height),r.graph.changeData(e),r.state.fitView&&r.graph.fitView(r.state.fitGap)})),Fe(Ne(r),"componentWillUnmount",(function(){window.removeEventListener("resize",r.resize)})),Fe(Ne(r),"initUtil",(function(){r.g6Api.init(r.graph),r.toolbarUtil.init(r.graph),r.graphEventUtil.init(r.graph),r.registerUtil.init(r.graph),r.registerUtil.baseUrl=r.state.baseUrl})),Fe(Ne(r),"initResizeEvent",(function(){window.addEventListener("resize",r.resize)})),Fe(Ne(r),"resize",(function(){clearTimeout(r.resizeTimer),r.resizeTimer=setTimeout((function(){}),500)})),Fe(Ne(r),"addListener",(function(e,t,r){"function"==typeof r&&e.on(t,r)})),r.graph=null,r.registerUtil=new w,r.graphEventUtil=new ue,r.toolbarUtil=new ye,r.g6Api=new we,r.resizeTimer=0,r.ctrlKey=!1,r.sourceRect={width:0,height:0,left:0,top:0,datas:[]},r}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.topoWrap.getBoundingClientRect();t&&(this.graph=new s.a.Graph({container:this.props.el,width:t.width,renderer:"canvas",height:t.height-4,fitView:this.state.fitView,pixeRatio:100,modes:{"default":["drag-canvas","zoom-canvas","click-select",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],addEdge:["addEdge","drag-node",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],addNode:["addNode","drag-node",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],edite:["drag-node","addEdge","addNode",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],show:["drag-canvas","zoom-canvas",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],multiselect:["drag-node","drag-canvas","click-select","zoom-canvas",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(t){return"text"===t.target.type&&!!e.ctrlKey}}],select:["drag-node",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}],drag:["drag-canvas",{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}]}}),this.sourceRect={width:t.width,height:t.height,datas:this.state.datas},this.initUtil(),this.initEvent(),this.toolbar&&(this.toolbar.toolbar=this.toolbarUtil),this.graph.setMode(this.state.model),this.setData(this.state.datas),this.graph.render()),document.onkeydown=function(t){e.ctrlKey=t.ctrlKey},document.onkeyup=function(t){e.ctrlKey=t.ctrlKey}}},{key:"initEvent",value:function(){var e=this,t=this.addListener;Se.forEach((function(r){var n=Oe[r];t(e.graph,"node:".concat(r),e.props["onNode".concat(n)]),t(e.graph,"edge:".concat(r),e.props["onEdge".concat(n)]),t(e.graph,"canvas:".concat(r),e.props["onCanvas".concat(n)])})),Te.forEach((function(r){t(e.page,[r],e.props[_e[r]])}))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"topowrap",ref:function(t){e.topoWrap=t}},o.a.createElement("div",{className:"topo-content",id:this.props.el}),this.state.showToolBar?o.a.createElement(Le,{ref:function(t){e.toolbar=t}}):null)}}])&&Ie(r.prototype,n),t}(o.a.Component);function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qe(e,t){return(qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Fe(Be,"defaultProps",{el:"topoEl",datas:[],baseUrl:"../demo/assets/",model:"drag",nodeMenu:[],edgeMenu:[],multiSelectFilter:[],showToolBar:!0,fitView:!0,moveCenter:!1,userLayout:!1,fitGap:100}),Fe(Be,"propTypes",{el:a.a.string.isRequired,datas:a.a.array.isRequired}),r(4);var Ke=function(e){function t(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this,n=He(t).call(this,e),r=!n||"object"!==ze(n)&&"function"!=typeof n?Ve(this):n,Ze(Ve(r),"state",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ge(r,!0).forEach((function(t){Ze(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ge(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r.props)),Ze(Ve(r),"destroy",(function(){r.graph&&(r.g6Api.cacheMap.clear(),r.graph.stopAnimate(),r.graph.destroy())})),Ze(Ve(r),"clear",(function(){r.graph&&(r.g6Api.cacheMap.clear(),r.graph.stopAnimate(),r.graph.clear())})),Ze(Ve(r),"shouldComponentUpdate",(function(e,t){var n=!1;return Object.keys(e).forEach((function(t){r.props.hasOwnProperty(t)&&e[t]!=r.props[t]&&(n=!0)})),r.props.datas!=e.datas&&(r.topoWrap.getBoundingClientRect(),r.graph&&(r.graph.clear(),r.graph.changeData(e.datas))),n})),Ze(Ve(r),"componentWillUnmount",(function(){window.removeEventListener("resize",r.resize)})),Ze(Ve(r),"initResizeEvent",(function(){window.addEventListener("resize",r.resize)})),Ze(Ve(r),"resize",(function(){clearTimeout(r.resizeTimer),r.resizeTimer=setTimeout((function(){}),500)})),Ze(Ve(r),"addListener",(function(e,t,r){"function"==typeof r&&e.on(t,r)})),r.graph=null,r.g6Api=new we,r.registerUtil=new w,r.preZoom=1,r.sourceRect={width:0,height:0,left:0,top:0,datas:[]},r.levelColos=["#FF0000","#FF0000","#FFA500","#FFFF00","#0000FF"],r}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.topoWrap.getBoundingClientRect();if(t){var r={dendrogram:{type:"dendrogram",direction:"LR",nodeSep:this.state.nodeSep,rankSep:this.state.rankSep,radial:this.state.radial}};this.graph=new s.a.TreeGraph({container:this.props.el,width:t.width,height:t.height-4,pixelRatio:2,modes:{"default":["drag-canvas","zoom-canvas",{type:"collapse-expand",onChange:function(t,r){if(r||(e.preZoom=e.graph.getZoom()),e.graph.refreshLayout(!0),e.graph.paint(),r){var n=e.graph.get("width"),o=e.graph.get("height");e.graph.zoomTo(e.preZoom,{x:n/2,y:o/2+.01*o})}return e.registerUtil.collapsed=r,r}},{type:"tooltip",formatText:function(e){return e.label},shouldUpdate:function(e){return!0}}]},fitView:!0,animate:!0,linkCenter:!1,layout:r.dendrogram});var n=this.state.datas;this.registerUtil.baseUrl=this.state.baseUrl,this.g6Api.init(this.graph),this.registerUtil.initTreeGraph(this.graph),this.registerUtil.g6Api=this.g6Api,this.graph.node((function(t){return{shape:"treenodeStyle",label:t.name,size:[t.w,t.h],id:t.id,img:e.state.baseUrl+t.imageName+"."+e.state.imageType,style:{cursor:"pointer"},labelCfg:{position:"bottom",style:{fill:"#00FFFF",fontSize:20}}}})),this.graph.edge((function(){return{color:"#fcfdfd",label:"",shape:"edgeStyle"}})),this.initEvent(),this.graph.data(n),this.graph.render()}}},{key:"initEvent",value:function(){var e=this,t=this.addListener;Se.forEach((function(r){var n=Oe[r];t(e.graph,"node:".concat(r),e.props["onNode".concat(n)]),t(e.graph,"edge:".concat(r),e.props["onEdge".concat(n)]),t(e.graph,"canvas:".concat(r),e.props["onCanvas".concat(n)])})),Te.forEach((function(r){t(e.page,[r],e.props[_e[r]])}))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"topowrap",ref:function(t){e.topoWrap=t}},o.a.createElement("div",{className:"topo-content",id:this.props.el}))}}])&&We(r.prototype,n),t}(o.a.Component);Ze(Ke,"defaultProps",{el:"topoEl",datas:[],baseUrl:"./demo/assets/",model:"multiselect",imageType:"png",nodeMenu:[],edgeMenu:[],showToolBar:!0,nodeSep:5,rankSep:400,radial:!0}),Ze(Ke,"propTypes",{el:a.a.string.isRequired,datas:a.a.array.isRequired});var Ye={version:"1.0",author:"maixing",TopoView:Be,TreeTopoView:Ke,EventBus:undefined,EventConsts:undefined};t["default"]=Ye}])}));