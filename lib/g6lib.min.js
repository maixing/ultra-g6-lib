!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("@antv/g6"),require("lodash")):"function"==typeof define&&define.amd?define(["react","@antv/g6","lodash"],t):"object"==typeof exports?exports["g6lib.min.js"]=t(require("react"),require("@antv/g6"),require("lodash")):e["g6lib.min.js"]=t(e.React,e["@antv/g6"],e.lodash)}(window,function(r,n,o){return s={},i.m=a=[function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t,r){e.exports=r(5)()},function(e,t){e.exports=o},function(e,t,r){},function(e,t,r){"use strict";var s=r(6);function n(){}function o(){}o.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,o,i){if(i!==s){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}var r={array:e.isRequired=e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return r.PropTypes=r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),o=r(2),a=r.n(o),s=r(1),c=r.n(s),u="multiselect",l="select";function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function n(){var e,t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),r=null,(t="graph")in(e=this)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}return e=n,(t=[{key:"init",value:function(e){this.graph=e}}])&&p(e.prototype,t),r&&p(e,r),n;var e,t,r}();function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t,r){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=[[0,0],[.5,0],[1,0],[0,.5],[1,.5],[0,1],[.5,1],[1,1]],O=["0xFF0000","#FF0000","#FFA500","#FFFF00","#0000FF"],E=function(){function r(){var a,e,t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),v(b((e=this,t=g(r).call(this),a=!t||"object"!==h(t)&&"function"!=typeof t?b(e):t)),"baseUrl",""),v(b(a),"registerEdge",function(){c.a.registerEdge("edgeStyle",{draw:function(e,t){var r=e.startPoint,n=e.endPoint,o="#ccc";return a.graph.getCurrentMode()==l&&e.selected&&(o="blue"),t.addShape("path",{attrs:{stroke:o,lineWidth:2,cursor:"pointer",endArrow:e.endArrow,path:[["M",r.x,r.y],["L",n.x,n.y]]}})}})}),v(b(a),"registerNode",function(){c.a.registerNode("nodeStyle",{draw:function(e,t){var r=parseFloat(e.w),n=parseFloat(e.h),o=a.graph.getCurrentMode();e.selected?u==o?t.addShape("image",{attrs:{x:r/2,y:-n/1.2,width:16,height:16,img:a.baseUrl+"ck.svg",cursor:"pointer"}}):t.addShape("rect",{attrs:{x:-r/2-a.selectGap,y:-n/2-a.selectGap,width:r+2*a.selectGap,height:n+2*a.selectGap,stroke:"red"}}):u==o&&t.addShape("image",{attrs:{x:r/2,y:-n/1.2,width:16,height:16,img:a.baseUrl+"uck.svg"}}),parseInt(e.alarm),console.log("cfg----\x3e>%o,%o",e);var i=t.addShape("image",{attrs:{x:-r/2,y:-n/2,width:r,height:n,cursor:"pointer",img:a.baseUrl+e.neType+".svg",shadowColor:O[parseInt(e.alarm)],shadowBlur:0<parseInt(e.alarm)?50:0,shadowOffsetX:0,shadowOffsetY:0}});return t.addShape("text",{attrs:{x:0,y:n,textAlign:"center",text:e.label,fill:"#FFF"}}),i},getAnchorPoints:function(e){return w}})}),a.selectGap=5,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(r,f),e=r,(t=[{key:"init",value:function(e){y(g(r.prototype),"init",this).call(this,e),this.registerNode(),this.registerEdge()}}])&&d(e.prototype,t),n&&d(e,n),r;var e,t,n}(),S=function(e,t){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function _(e,t){function r(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function j(e){return"function"==typeof e}var x=!1,P={Promise:undefined,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,x=e},get useDeprecatedSynchronousErrorHandling(){return x}};function T(e){setTimeout(function(){throw e},0)}var k={closed:!0,next:function(e){},error:function(e){if(P.useDeprecatedSynchronousErrorHandling)throw e;T(e)},complete:function(){}},C=Array.isArray||function(e){return e&&"number"==typeof e.length};function M(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}M.prototype=Object.create(Error.prototype);var D=M,N=function(){function u(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}var e;return u.prototype.unsubscribe=function(){var e;if(!this.closed){var t,r=this._parentOrParents,n=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof u)r.remove(this);else if(null!==r)for(var i=0;i<r.length;++i)r[i].remove(this);if(j(n))try{n.call(this)}catch(c){e=c instanceof D?A(c.errors):[c]}if(C(o)){i=-1;for(var a=o.length;++i<a;){var s=o[i];if(null!==(t=s)&&"object"==typeof t)try{s.unsubscribe()}catch(c){e=e||[],c instanceof D?e=e.concat(A(c.errors)):e.push(c)}}}if(e)throw new D(e)}},u.prototype.add=function(e){var t=e;if(!e)return u.EMPTY;switch(typeof e){case"function":t=new u(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof u)){var r=t;(t=new u)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var n=t._parentOrParents;if(null===n)t._parentOrParents=this;else if(n instanceof u){if(n===this)return t;t._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return t;n.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[t]:o.push(t),t},u.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},u.EMPTY=((e=new u).closed=!0,e),u}();function A(e){return e.reduce(function(e,t){return e.concat(t instanceof D?t.errors:t)},[])}var R="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),F=function(o){function i(e,t,r){var n=o.call(this)||this;switch(n.syncErrorValue=null,n.syncErrorThrown=!1,n.syncErrorThrowable=!1,n.isStopped=!1,arguments.length){case 0:n.destination=k;break;case 1:if(!e){n.destination=k;break}if("object"==typeof e){e instanceof i?(n.syncErrorThrowable=e.syncErrorThrowable,(n.destination=e).add(n)):(n.syncErrorThrowable=!0,n.destination=new I(n,e));break}default:n.syncErrorThrowable=!0,n.destination=new I(n,e,t,r)}return n}return _(i,o),i.prototype[R]=function(){return this},i.create=function(e,t,r){var n=new i(e,t,r);return n.syncErrorThrowable=!1,n},i.prototype.next=function(e){this.isStopped||this._next(e)},i.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},i.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},i.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this))},i.prototype._next=function(e){this.destination.next(e)},i.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},i.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},i.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},i}(N),I=function(s){function e(e,t,r,n){var o,i=s.call(this)||this;i._parentSubscriber=e;var a=i;return j(t)?o=t:t&&(o=t.next,r=t.error,n=t.complete,t!==k&&(j((a=Object.create(t)).unsubscribe)&&i.add(a.unsubscribe.bind(a)),a.unsubscribe=i.unsubscribe.bind(i))),i._context=a,i._next=o,i._error=r,i._complete=n,i}return _(e,s),e.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;P.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},e.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=P.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?this.__tryOrSetError(t,this._error,e):this.__tryOrUnsub(this._error,e),this.unsubscribe();else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):T(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;T(e)}}},e.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};P.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,r):this.__tryOrUnsub(r),this.unsubscribe()}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(r){if(this.unsubscribe(),P.useDeprecatedSynchronousErrorHandling)throw r;T(r)}},e.prototype.__tryOrSetError=function(e,t,r){if(!P.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(n){return P.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0):(T(n),!0)}return!1},e.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},e}(F),U="function"==typeof Symbol&&Symbol.observable||"@@observable";function B(){}var z=function(){function r(e){this._isScalar=!1,e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,r){var n=this.operator,o=function(e,t,r){if(e){if(e instanceof F)return e;if(e[R])return e[R]()}return e||t||r?new F(e,t,r):new F(k)}(e,t,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||P.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),P.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){P.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function ub(t){for(;t;){var r=t,n=r.closed,o=r.destination,i=r.isStopped;if(n||i)return!1;t=o&&o instanceof F?o:null}return!0}(e)?e.error(t):console.warn(t)}},r.prototype.forEach=function(o,e){var t=this;return new(e=L(e))(function(e,r){var n;n=t.subscribe(function(e){try{o(e)}catch(t){r(t),n&&n.unsubscribe()}},r,e)})},r.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},r.prototype[U]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:function r(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(e,t){return t(e)},e)}:B}(e)(this)},r.prototype.toPromise=function(e){var n=this;return new(e=L(e))(function(e,t){var r;n.subscribe(function(e){return r=e},function(e){return t(e)},function(){return e(r)})})},r.create=function(e){return new r(e)},r}();function L(e){if(!(e=e||P.Promise||Promise))throw new Error("no Promise impl found");return e}function V(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}V.prototype=Object.create(Error.prototype);var H,q,W=V,G=function(n){function e(e,t){var r=n.call(this)||this;return r.subject=e,r.subscriber=t,r.closed=!1,r}return _(e,n),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},e}(N),Y=function(r){function e(e){var t=r.call(this,e)||this;return t.destination=e,t}return _(e,r),e}(F),Z=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _(e,t),e.prototype[R]=function(){return new Y(this)},e.prototype.lift=function(e){var t=new X(this,this);return t.operator=e,t},e.prototype.next=function(e){if(this.closed)throw new W;if(!this.isStopped)for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].next(e)},e.prototype.error=function(e){if(this.closed)throw new W;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].error(e);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new W;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new W;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(e){if(this.closed)throw new W;return this.hasError?(e.error(this.thrownError),N.EMPTY):this.isStopped?(e.complete(),N.EMPTY):(this.observers.push(e),new G(this,e))},e.prototype.asObservable=function(){var e=new z;return e.source=this,e},e.create=function(e,t){return new X(e,t)},e}(z),X=function(n){function e(e,t){var r=n.call(this)||this;return r.destination=e,r.source=t,r}return _(e,n),e.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},e.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},e.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},e.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):N.EMPTY},e}(Z),K=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new J(e,this.predicate,this.thisArg))},e}(),J=function(o){function e(e,t,r){var n=o.call(this,e)||this;return n.predicate=t,n.thisArg=r,n.count=0,n}return _(e,o),e.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}t&&this.destination.next(e)},e}(F),Q=r(3),$=new Z,ee=new Map,te=($.pipe((H=function(e){return!!ee.has(e.type)},function(e){return e.lift(new K(H,q))})).subscribe(function(r){var e=ee.get(r.type);e&&e.map(function(e,t){e&&Object(Q.isFunction)(e)&&Object(Q.has)(r,"data")&&e.call(null,r.data)})}),function te(e,t){var r=[];ee.has(e)&&(r=ee.get(e)),-1==r.indexOf(t)&&r.push(t),ee.set(e,r)}),re="TOOLBAR_MULTI_SELECT";function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(e,t,r){return(ae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=se(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var le=function(){function r(){var o,e,t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),ue(ie((e=this,t=se(r).call(this),o=!t||"object"!==ne(t)&&"function"!=typeof t?ie(e):t)),"preSelectNode",null),ue(ie(o),"preSelectNodes",[]),ue(ie(o),"preSelectEdge",null),ue(ie(o),"edge",null),ue(ie(o),"addingEdge",!1),ue(ie(o),"initToolBarEvent",function(){te(re,function(e){e||(o.graph.findAll("node",function(e){return e.get("model").x}).forEach(function(e){var t=e.getModel();t.selected=!1,o.graph.updateItem(e,t)}),o.preSelectNodes.splice(0))})}),ue(ie(o),"initNodeEvent",function(){o.graph.on("node:click",function(e){var r=e.item.getModel();r.selected=!r.selected;var t=o.graph.getCurrentMode();if(u==t)if(r.selected)o.preSelectNodes.push(r);else{var n=null;o.preSelectNodes.forEach(function(e,t){e.id==r.id&&(n=t)}),n&&o.preSelectNodes.splice(n,1)}else o.clearSelect(),o.preSelectNode=e.item;o.graph.updateItem(e.item,r)}),o.graph.on("node:mouseover",function(e){o.changeAnchor(e,!0)}),o.graph.on("node:mouseout",function(e){o.changeAnchor(e,!1)})}),ue(ie(o),"initEdgeEvent",function(){o.graph.on("edge:click",function(e){var t=e.item.getModel();t.selected=!t.selected;var r=e.item;o.clearSelect(),o.preSelectEdge!=r?(o.graph.updateItem(r,t),o.preSelectEdge=r):o.preSelectEdge=null})}),ue(ie(o),"initGlobalEvent",function(){o.graph.on("canvas:click",function(e){o.clearSelect()})}),ue(ie(o),"initBehavior",function(){console.log("initBehavior----\x3e>%o"),c.a.registerBehavior("addNode",{getEvents:function(){return{"canvas:click":"onClick"}},onClick:function(e){this.graph.addItem("node",{w:48,h:48,type:"default",shape:"nodeStyle",label:"ellipse",img:"../demo/assets/123.svg",selected:!1,x:e.x,y:e.y,id:c.a.Util.uniqueId()})}}),c.a.registerBehavior("addEdge",{getEvents:function(){return{"node:click":"onClick",mousemove:"onMousemove","edge:click":"onEdgeClick"}},onClick:function(e){console.log("onClick----\x3e>%o",e);var t=e.item,r={x:e.x,y:e.y},n=t.getModel();this.addingEdge&&this.edge?(this.graph.updateItem(this.edge,{target:n.id}),this.edge=null,this.addingEdge=!1):(this.edge=this.graph.addItem("edge",{source:n.id,target:r,shape:"edgeStyle",selected:!1,endArrow:!0}),this.addingEdge=!0)},onMousemove:function(e){var t={x:e.x,y:e.y};this.addingEdge&&this.edge&&this.graph.updateItem(this.edge,{target:t})},onEdgeClick:function(e){var t=e.item;this.addingEdge&&this.edge==t&&(this.graph.removeItem(this.edge),this.edge=null,this.addingEdge=!1)}}),o.graph.addBehaviors("addEdge","addEdge"),o.graph.addBehaviors("addNode","addNode")}),ue(ie(o),"changeAnchor",function(e,t){if(!e.target.isKeyShape){var r=e.target._attrs;r.cursor="crosshair",e.target._cfg,("inner"==r.type?r.outer:e.target).animate({r:t?10:7,repeat:!1},500,"easeCubic",null,0)}}),ue(ie(o),"clearSelect",function(){if(o.preSelectNode){var e=o.preSelectNode.getModel();e.selected=!1,o.graph.updateItem(o.preSelectNode,e),o.preSelectNode=null}if(o.preSelectEdge){var t=o.preSelectEdge.getModel();t.selected=!1,o.graph.updateItem(o.preSelectEdge,t),o.preSelectEdge=null}}),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(r,f),e=r,(t=[{key:"init",value:function(e){ae(se(r.prototype),"init",this).call(this,e),this.graph&&(this.initNodeEvent(),this.initEdgeEvent(),this.initGlobalEvent(),this.initBehavior(),this.initToolBarEvent())}}])&&oe(e.prototype,t),n&&oe(e,n),r;var e,t,n}();function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ye=function(){function n(){var r,e,t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),be(he((e=this,t=fe(n).call(this),r=!t||"object"!==pe(t)&&"function"!=typeof t?he(e):t)),"onDrag",function(e){r.graph.setMode(e.model),r.graph.refresh()}),be(he(r),"onEdit",function(e){r.graph.setMode(e.model),r.graph.refresh()}),be(he(r),"onSelect",function(e){r.graph.setMode(e.model),r.graph.refresh()}),be(he(r),"onZoomin",function(e){if(r.graph){var t=r.graph.getZoom();r.graph.zoomTo(t+.5)}}),be(he(r),"onZoomout",function(e){if(r.graph){var t=r.graph.getZoom();r.graph.zoomTo(t-.5)}}),be(he(r),"onCancel",function(e){}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(n,f),n}();function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ee=function(){function r(){var i,e,t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),Oe(ve((e=this,t=me(r).call(this),i=!t||"object"!==ge(t)&&"function"!=typeof t?ve(e):t)),"getNodes",function(){}),Oe(ve(i),"getLines",function(){}),Oe(ve(i),"updateDatas",function(e){}),Oe(ve(i),"clearDatas",function(){}),Oe(ve(i),"getAllData",function(){}),Oe(ve(i),"addAlarm",function(e,t,r){console.log("----\x3e>%o,%o",e,t);var n=i.graph.findById(e);if(n){var o=n.getModel();o.alarm=t.toString(),console.log("addAlarm----\x3e>%o",o),i.graph.updateItem(n,o)}}),Oe(ve(i),"addAlarms",function(e,t,r){}),Oe(ve(i),"clearAlarm",function(e,t){}),Oe(ve(i),"clearAlarms",function(e,t){}),Oe(ve(i),"getSelectsNode",function(){var e=i.graph.getNodes(),r=[];return e.forEach(function(e){var t=e.getModel();t.selected&&r.push(t)}),r}),Oe(ve(i),"updateSelectNode",function(e){}),Oe(ve(i),"updateNodeById",function(e,t){}),Oe(ve(i),"removeNodeById",function(){}),Oe(ve(i),"removeNodeByIds",function(e){}),Oe(ve(i),"addNode",function(e){}),Oe(ve(i),"getNodeById",function(e){var t=i.graph.findById(e);if(t)return t.getModel()}),Oe(ve(i),"getSelectLine",function(){var e=i.graph.getEdges(),r=[];return e.forEach(function(e){var t=e.getModel();t.selected&&r.push(t)}),r}),Oe(ve(i),"updateLineStyle",function(e,t){}),Oe(ve(i),"removeLineById",function(e){}),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(r,f),r}(),Se={click:"Click",contextmenu:"ContextMenu",dblclick:"DoubleClick",drag:"Drag",dragend:"DragEnd",dragenter:"DragEnter",dragleave:"DragLeave",dragstart:"DragStart",drop:"Drop",mousedown:"MouseDown",mouseenter:"MouseEnter",mouseleave:"MouseLeave",mouseover:"MouseMover",mouseup:"MouseUp",mouseout:"MouseOut"},_e={beforeadditem:"onBeforeadditem",afteradditem:"onAfteradditem",beforeremoveitem:"onBeforeremoveitem",afterremoveitem:"onAfterremoveitem",beforeupdateitem:"onBeforeupdateitem",afterupdateitem:"onAfterupdateitem",beforeitemvisibilitychange:"onBeforeitemvisibilitychange",afteritemvisibilitychange:"onAfteritemvisibilitychange",beforeitemstatechange:"onBeforeitemstatechange",afteritemstatechange:"onAfteritemstatechange",beforeitemrefresh:"onBeforeitemrefresh",afteritemrefresh:"onAfteritemrefresh",beforeitemstatesclear:"onBeforeitemstatesclear",afteritemstatesclear:"onAfteritemstatesclear"},je=Object.keys(Se),xe=Object.keys(_e);function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ne=function(){function o(e){var n,t,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),De(Ce((t=this,r=ke(o).call(this,e),n=!r||"object"!==Pe(r)&&"function"!=typeof r?Ce(t):r)),"state",{currentIndex:-1}),De(Ce(n),"toolbar",null),De(Ce(n),"onIconClick",function(e,t){var r=-1;e.index!=n.state.currentIndex&&(r=e.index),r=e.index,n.setState({currentIndex:r}),n.toolbar&&n.toolbar["on".concat(e.eventType)](e)}),n.icons=[{name:"拖动",icon:"drag",eventType:"Drag",model:"drag",index:1},{name:"编辑",icon:"edit",eventType:"Edit",model:"edite",index:2},{name:"选择",icon:"select",eventType:"Select",model:"select",index:3},{name:"放大",icon:"zoomin",eventType:"Zoomin",index:4},{name:"缩小",icon:"zoomout",eventType:"Zoomout",index:5},{name:"取消",icon:"cancel",eventType:"Cancel",index:6}],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(o,i.a.Component),e=o,(t=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var r=this;return i.a.createElement("div",{className:"toolbar-wrap"},this.icons.map(function(e,t){return i.a.createElement("span",{className:"toolbaricon ".concat(r.state.currentIndex==e.index?"toolbaricon-select":"toolbaricon-unselect"),onClick:r.onIconClick.bind(r,e)},i.a.createElement("span",{className:"icon ".concat(e.icon),title:e.name}))}))}}])&&Te(e.prototype,t),r&&Te(e,r),o;var e,t,r}();function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function Fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(4);var Le=function(){function o(e){var n,t,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),ze(Ue((t=this,r=Ie(o).call(this,e),n=!r||"object"!==Ae(r)&&"function"!=typeof r?Ue(t):r)),"state",function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Re(r,!0).forEach(function(e){ze(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Re(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},n.props)),ze(Ue(n),"destroy",function(){n.graph&&n.graph.destroy()}),ze(Ue(n),"shouldComponentUpdate",function(t,e){var r=!1;return Object.keys(t).forEach(function(e){n.props.hasOwnProperty(e)&&t[e]!=n.props[e]&&(r=!0)}),n.props.datas!=t.datas&&n.graph&&n.setData(t.datas,!0),r}),ze(Ue(n),"setData",function(e){var t=1<arguments.length&&arguments[1]!==undefined&&arguments[1],r=0;e.nodes.forEach(function(e){var t=parseInt(e.y);r<t&&(r=t)}),t&&n.graph.clear(),n.graph.changeSize(n.sourceRect.width,r>n.sourceRect.height?1.05*r:n.sourceRect.height),n.graph.changeData(e)}),ze(Ue(n),"componentWillUnmount",function(){window.removeEventListener("resize",n.resize)}),ze(Ue(n),"initUtil",function(){n.g6Api.init(n.graph),n.toolbarUtil.init(n.graph),n.graphEventUtil.init(n.graph),n.registerUtil.init(n.graph),n.registerUtil.baseUrl=n.state.baseUrl}),ze(Ue(n),"initResizeEvent",function(){window.addEventListener("resize",n.resize)}),ze(Ue(n),"resize",function(){clearTimeout(n.resizeTimer),n.resizeTimer=setTimeout(function(){},500)}),ze(Ue(n),"addListener",function(e,t,r){"function"==typeof r&&e.on(t,r)}),n.graph=null,n.registerUtil=new E,n.graphEventUtil=new le,n.toolbarUtil=new ye,n.g6Api=new Ee,n.resizeTimer=0,n.sourceRect={width:0,height:0,left:0,top:0,datas:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(o,i.a.Component),e=o,(t=[{key:"componentDidMount",value:function(){var e=this.topoWrap.getBoundingClientRect();e&&(this.graph=new c.a.Graph({container:this.props.el,width:e.width,height:e.height-4,render:"svg",fitView:this.state.fitView,modes:{addEdge:["addEdge","drag-node"],addNode:["addNode","drag-node"],edite:["drag-node","addEdge","addNode"],show:["drag-canvas","zoom-canvas"],multiselect:["drag-node"],select:["drag-node"],drag:["drag-canvas"]}}),this.sourceRect={width:e.width,height:e.height,datas:this.state.datas},this.initUtil(),this.initEvent(),this.toolbar&&(this.toolbar.toolbar=this.toolbarUtil),this.graph.setMode(this.state.model),this.setData(this.state.datas),this.graph.render(),this.graph.setAutoPaint(!0))}},{key:"initEvent",value:function(){var r=this,n=this.addListener;je.forEach(function(e){var t=Se[e];n(r.graph,"node:".concat(e),r.props["onNode".concat(t)]),n(r.graph,"edge:".concat(e),r.props["onEdge".concat(t)]),n(r.graph,"canvas:".concat(e),r.props["onCanvas".concat(t)])}),xe.forEach(function(e){n(r.page,[e],r.props[_e[e]])})}},{key:"render",value:function(){var t=this;return i.a.createElement("div",{className:"topowrap",ref:function(e){t.topoWrap=e}},i.a.createElement("div",{className:"topo-content",id:this.props.el}),this.state.showToolBar?i.a.createElement(Ne,{ref:function(e){t.toolbar=e}}):null)}}])&&Fe(e.prototype,t),r&&Fe(e,r),o;var e,t,r}();function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ze(Le,"defaultProps",{el:"topoEl",datas:[],baseUrl:"../demo/assets/",model:"drag",nodeMenu:[],edgeMenu:[],showToolBar:!0,fitView:!0,fitGap:100}),ze(Le,"propTypes",{el:a.a.string.isRequired,datas:a.a.array.isRequired}),r(4);var Xe=function(){function n(e){var i,t,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),Ze(Ge((t=this,r=We(n).call(this,e),i=!r||"object"!==Ve(r)&&"function"!=typeof r?Ge(t):r)),"state",function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?He(r,!0).forEach(function(e){Ze(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):He(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},i.props)),Ze(Ge(i),"destroy",function(){i.graph&&i.graph.destroy()}),Ze(Ge(i),"shouldComponentUpdate",function(t,e){var r=!1;if(Object.keys(t).forEach(function(e){i.props.hasOwnProperty(e)&&t[e]!=i.props[e]&&(r=!0)}),i.props.datas!=t.datas){console.log("nextProps.datas----\x3e>%o",t.datas);var n=i.topoWrap.getBoundingClientRect();i.graph&&(i.graph.clear(),t.datas.hasOwnProperty("children")&&0<t.datas.children.length?(i.graph.set("animate",!0),i.graph.fitView([30*n.height/100,20*n.width/100])):(i.graph.set("animate",!1),n&&i.graph.fitView([40*n.height/100,20*n.width/100])),i.graph.changeData(t.datas))}return r}),Ze(Ge(i),"componentWillUnmount",function(){window.removeEventListener("resize",i.resize)}),Ze(Ge(i),"initResizeEvent",function(){window.addEventListener("resize",i.resize)}),Ze(Ge(i),"resize",function(){clearTimeout(i.resizeTimer),i.resizeTimer=setTimeout(function(){},500)}),Ze(Ge(i),"addListener",function(e,t,r){"function"==typeof r&&e.on(t,r)}),Ze(Ge(i),"register",function(){c.a.registerNode("treenodeStyle",{draw:function(e,t){var r=parseFloat(e.w),n=parseFloat(e.h);i.graph.getCurrentMode(),console.log("tree node----\x3e>%o",e);var o=t.addShape("image",{attrs:{x:-r/2,y:-n/2,width:r,height:n,cursor:"pointer",img:i.state.baseUrl+e.imageName+"."+i.state.imageType,shadowColor:i.levelColos[parseInt(e.alarm)],shadowBlur:0<parseInt(e.alarm)?50:0,shadowOffsetX:0,shadowOffsetY:0}});return t.addShape("text",{attrs:{x:0,y:1==e.index?.6*n:n,textAlign:"center",text:e.label,fill:"#FFF",fontSize:e.index?6+2*(4-e.index):12}}),o}})}),i.graph=null,i.g6Api=new Ee,i.sourceRect={width:0,height:0,left:0,top:0,datas:[]},i.levelColos=["0xFF0000","#FF0000","#FFA500","#FFFF00","#0000FF"],i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(n,i.a.Component),e=n,(t=[{key:"componentDidMount",value:function(){var t=this;this.register();var e=this.topoWrap.getBoundingClientRect();if(e){var r={dendrogram:{type:"dendrogram",direction:"LR",nodeSep:this.state.nodeSep,rankSep:this.state.rankSep,radial:!1}};this.graph=new c.a.TreeGraph({container:this.props.el,width:e.width,height:e.height-4,pixelRatio:2,modes:{"default":["drag-canvas"]},fitView:!0,animate:!1,layout:r.dendrogram}),this.graph.node(function(e){return{shape:"treenodeStyle",label:e.name,size:[e.w,e.h],img:t.state.baseUrl+e.imageName+"."+t.state.imageType,style:{cursor:"pointer"},labelCfg:{position:"bottom",style:{fill:"#fcfdfd",fontSize:e.index?6+2*(4-e.index):12}}}}),this.graph.edge(function(){return{color:"#fcfdfd",label:""}}),this.initEvent(),this.g6Api.init(this.graph),this.graph.data(this.state.datas),this.graph.render()}}},{key:"initEvent",value:function(){var r=this,n=this.addListener;je.forEach(function(e){var t=Se[e];n(r.graph,"node:".concat(e),r.props["onNode".concat(t)]),n(r.graph,"edge:".concat(e),r.props["onEdge".concat(t)]),n(r.graph,"canvas:".concat(e),r.props["onCanvas".concat(t)])}),xe.forEach(function(e){n(r.page,[e],r.props[_e[e]])})}},{key:"render",value:function(){var t=this;return i.a.createElement("div",{className:"topowrap",ref:function(e){t.topoWrap=e}},i.a.createElement("div",{className:"topo-content",id:this.props.el}))}}])&&qe(e.prototype,t),r&&qe(e,r),n;var e,t,r}();Ze(Xe,"defaultProps",{el:"topoEl",datas:[],baseUrl:"../demo/assets/",model:"multiselect",imageType:"png",nodeMenu:[],edgeMenu:[],showToolBar:!0,nodeSep:1e3,rankSep:100}),Ze(Xe,"propTypes",{el:a.a.string.isRequired,datas:a.a.array.isRequired});var Ke={version:"1.0",author:"maixing",TopoView:Le,TreeTopoView:Xe,EventBus:undefined,EventConsts:undefined};t["default"]=Ke}],i.c=s,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=7);function i(e){if(s[e])return s[e].exports;var t=s[e]={i:e,l:!1,exports:{}};return a[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var a,s});